<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Stats in the Wild: Good Data Practices | R Companion to Real Econometrics</title>
  <meta name="description" content="R, RStudio IDE, and the tidyverse companion to Bailey’s Real Econometrics" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Stats in the Wild: Good Data Practices | R Companion to Real Econometrics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="R, RStudio IDE, and the tidyverse companion to Bailey’s Real Econometrics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Stats in the Wild: Good Data Practices | R Companion to Real Econometrics" />
  
  <meta name="twitter:description" content="R, RStudio IDE, and the tidyverse companion to Bailey’s Real Econometrics" />
  

<meta name="author" content="Tony Carilli" />


<meta name="date" content="2020-08-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chp1.html"/>
<link rel="next" href="cph3.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.15/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Companion to *Real Econometrics*</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#install-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> Install R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#using-rstudio"><i class="fa fa-check"></i><b>2.2</b> Using RStudio</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#source-pane"><i class="fa fa-check"></i><b>2.2.1</b> Source Pane</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#environmenthistory-pane"><i class="fa fa-check"></i><b>2.2.2</b> Environment/History Pane</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#console-pane"><i class="fa fa-check"></i><b>2.2.3</b> Console Pane</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#filesplotspackageshelp-pane"><i class="fa fa-check"></i><b>2.2.4</b> Files/Plots/Packages/Help Pane</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#r-markdown"><i class="fa fa-check"></i><b>2.3</b> R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chp1.html"><a href="chp1.html"><i class="fa fa-check"></i><b>3</b> The Quest for Causality</a><ul>
<li class="chapter" data-level="3.1" data-path="chp1.html"><a href="chp1.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="chp1.html"><a href="chp1.html#table-1.1"><i class="fa fa-check"></i><b>3.1.1</b> Table 1.1</a></li>
<li class="chapter" data-level="3.1.2" data-path="chp1.html"><a href="chp1.html#figure-1.2"><i class="fa fa-check"></i><b>3.1.2</b> Figure 1.2</a></li>
<li class="chapter" data-level="3.1.3" data-path="chp1.html"><a href="chp1.html#figure-1.3"><i class="fa fa-check"></i><b>3.1.3</b> Figure 1.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chp2.html"><a href="chp2.html"><i class="fa fa-check"></i><b>4</b> Stats in the Wild: Good Data Practices</a><ul>
<li class="chapter" data-level="4.1" data-path="chp1.html"><a href="chp1.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="chp2.html"><a href="chp2.html#table-and-figure-reproduction"><i class="fa fa-check"></i><b>4.2</b> Table and Figure Reproduction</a><ul>
<li class="chapter" data-level="4.2.1" data-path="chp2.html"><a href="chp2.html#table-2.1"><i class="fa fa-check"></i><b>4.2.1</b> Table 2.1</a></li>
<li class="chapter" data-level="4.2.2" data-path="chp2.html"><a href="chp2.html#table-2.2"><i class="fa fa-check"></i><b>4.2.2</b> Table 2.2</a></li>
<li class="chapter" data-level="4.2.3" data-path="chp2.html"><a href="chp2.html#table-2.5"><i class="fa fa-check"></i><b>4.2.3</b> Table 2.5</a></li>
<li class="chapter" data-level="4.2.4" data-path="chp2.html"><a href="chp2.html#figure-2.3"><i class="fa fa-check"></i><b>4.2.4</b> Figure 2.3</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chp2.html"><a href="chp2.html#computing-center"><i class="fa fa-check"></i><b>4.3</b> Computing Center</a><ul>
<li class="chapter" data-level="4.3.1" data-path="chp2.html"><a href="chp2.html#reading-data"><i class="fa fa-check"></i><b>4.3.1</b> Reading Data</a></li>
<li class="chapter" data-level="4.3.2" data-path="chp2.html"><a href="chp2.html#manually-entering-data"><i class="fa fa-check"></i><b>4.3.2</b> Manually Entering Data</a></li>
<li class="chapter" data-level="4.3.3" data-path="chp2.html"><a href="chp2.html#simple-statistics"><i class="fa fa-check"></i><b>4.3.3</b> Simple Statistics</a></li>
<li class="chapter" data-level="4.3.4" data-path="chp2.html"><a href="chp2.html#subsetting"><i class="fa fa-check"></i><b>4.3.4</b> Subsetting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cph3.html"><a href="cph3.html"><i class="fa fa-check"></i><b>5</b> Bivariate OLS: The Foundation of Econometric Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="cph3.html"><a href="cph3.html#estimating-a-simple-regression"><i class="fa fa-check"></i><b>5.1</b> Estimating a simple regression</a></li>
<li class="chapter" data-level="5.2" data-path="cph3.html"><a href="cph3.html#scatter-plot-with-regression-line"><i class="fa fa-check"></i><b>5.2</b> scatter Plot with Regression Line</a></li>
<li class="chapter" data-level="5.3" data-path="cph3.html"><a href="cph3.html#subsetting-data-for-regressions"><i class="fa fa-check"></i><b>5.3</b> Subsetting Data for Regressions</a></li>
<li class="chapter" data-level="5.4" data-path="cph3.html"><a href="cph3.html#heteroscesdasticity-consistent-standard-errors."><i class="fa fa-check"></i><b>5.4</b> Heteroscesdasticity-consistent standard errors.</a></li>
<li class="chapter" data-level="5.5" data-path="cph3.html"><a href="cph3.html#generating-random-numbers"><i class="fa fa-check"></i><b>5.5</b> Generating Random Numbers</a></li>
<li class="chapter" data-level="5.6" data-path="cph3.html"><a href="cph3.html#simulations"><i class="fa fa-check"></i><b>5.6</b> Simulations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chp4.html"><a href="chp4.html"><i class="fa fa-check"></i><b>6</b> Hypothesis Testing and Interval Estimation; Answering Research Questions</a><ul>
<li class="chapter" data-level="6.1" data-path="chp4.html"><a href="chp4.html#computing-corner"><i class="fa fa-check"></i><b>6.1</b> Computing Corner</a><ul>
<li class="chapter" data-level="6.1.1" data-path="chp4.html"><a href="chp4.html#probability-distributions-in-r"><i class="fa fa-check"></i><b>6.1.1</b> Probability Distributions in R</a></li>
<li class="chapter" data-level="6.1.2" data-path="chp4.html"><a href="chp4.html#critical-values-in-r"><i class="fa fa-check"></i><b>6.1.2</b> Critical Values in R</a></li>
<li class="chapter" data-level="6.1.3" data-path="chp4.html"><a href="chp4.html#confidence-intervals-for-ols-estimates"><i class="fa fa-check"></i><b>6.1.3</b> Confidence Intervals for OLS estimates</a></li>
<li class="chapter" data-level="6.1.4" data-path="chp4.html"><a href="chp4.html#power-curves"><i class="fa fa-check"></i><b>6.1.4</b> Power Curves</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chp5.html"><a href="chp5.html"><i class="fa fa-check"></i><b>7</b> Multivariate OLS: Where the Action Is</a><ul>
<li class="chapter" data-level="7.1" data-path="chp4.html"><a href="chp4.html#computing-corner"><i class="fa fa-check"></i><b>7.1</b> Computing Corner</a><ul>
<li class="chapter" data-level="7.1.1" data-path="chp5.html"><a href="chp5.html#multiple-regression"><i class="fa fa-check"></i><b>7.1.1</b> Multiple Regression</a></li>
<li class="chapter" data-level="7.1.2" data-path="chp5.html"><a href="chp5.html#multicollinearity"><i class="fa fa-check"></i><b>7.1.2</b> Multicollinearity</a></li>
<li class="chapter" data-level="7.1.3" data-path="chp5.html"><a href="chp5.html#standardized-coefficients"><i class="fa fa-check"></i><b>7.1.3</b> Standardized Coefficients</a></li>
<li class="chapter" data-level="7.1.4" data-path="chp5.html"><a href="chp5.html#f-tests"><i class="fa fa-check"></i><b>7.1.4</b> <em>F</em> tests</a></li>
<li class="chapter" data-level="7.1.5" data-path="chp5.html"><a href="chp5.html#examples"><i class="fa fa-check"></i><b>7.1.5</b> Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chp6.html"><a href="chp6.html"><i class="fa fa-check"></i><b>8</b> Dummy Variables: Smarter than You Think</a><ul>
<li class="chapter" data-level="8.1" data-path="chp6.html"><a href="chp6.html#dummy-variables-in-r"><i class="fa fa-check"></i><b>8.1</b> Dummy Variables in R</a><ul>
<li class="chapter" data-level="8.1.1" data-path="chp6.html"><a href="chp6.html#factors"><i class="fa fa-check"></i><b>8.1.1</b> Factors</a></li>
<li class="chapter" data-level="8.1.2" data-path="chp6.html"><a href="chp6.html#character-vectors-as-dummies"><i class="fa fa-check"></i><b>8.1.2</b> Character Vectors as Dummies</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="chp6.html"><a href="chp6.html#difference-in-means-test"><i class="fa fa-check"></i><b>8.2</b> Difference in Means Test</a><ul>
<li class="chapter" data-level="8.2.1" data-path="chp6.html"><a href="chp6.html#using-t.test"><i class="fa fa-check"></i><b>8.2.1</b> Using <code>t.test</code></a></li>
<li class="chapter" data-level="8.2.2" data-path="chp6.html"><a href="chp6.html#using-lm-and-lm_robust"><i class="fa fa-check"></i><b>8.2.2</b> Using <code>lm</code> and <code>lm_robust</code></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="chp6.html"><a href="chp6.html#integer-and-numerical-vectors-as-dummy-variables"><i class="fa fa-check"></i><b>8.3</b> Integer and Numerical Vectors as Dummy Variables</a></li>
<li class="chapter" data-level="8.4" data-path="chp6.html"><a href="chp6.html#manipulating-factors"><i class="fa fa-check"></i><b>8.4</b> Manipulating Factors</a></li>
<li class="chapter" data-level="8.5" data-path="chp6.html"><a href="chp6.html#dummy-interaction-variables"><i class="fa fa-check"></i><b>8.5</b> Dummy Interaction Variables</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chp7.html"><a href="chp7.html"><i class="fa fa-check"></i><b>9</b> Specifying Models</a><ul>
<li class="chapter" data-level="9.1" data-path="chp7.html"><a href="chp7.html#polynomial-models"><i class="fa fa-check"></i><b>9.1</b> Polynomial Models</a></li>
<li class="chapter" data-level="9.2" data-path="chp7.html"><a href="chp7.html#logarithmic"><i class="fa fa-check"></i><b>9.2</b> Logarithmic</a><ul>
<li class="chapter" data-level="9.2.1" data-path="chp7.html"><a href="chp7.html#constant-elasticity-log-log-or-double-log"><i class="fa fa-check"></i><b>9.2.1</b> Constant Elasticity (log-log or double log)</a></li>
<li class="chapter" data-level="9.2.2" data-path="chp7.html"><a href="chp7.html#constant-growth-in-a-dependent-variable-log-lin-or-semilog"><i class="fa fa-check"></i><b>9.2.2</b> Constant Growth in a Dependent Variable (log-lin or semilog)</a></li>
<li class="chapter" data-level="9.2.3" data-path="chp7.html"><a href="chp7.html#constant-change-in-dependent-variable-lin-log"><i class="fa fa-check"></i><b>9.2.3</b> Constant % Change in Dependent Variable (lin-log)</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chp7.html"><a href="chp7.html#other-useful-functional-forms"><i class="fa fa-check"></i><b>9.3</b> Other Useful Functional Forms</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chp8.html"><a href="chp8.html"><i class="fa fa-check"></i><b>10</b> Using Fixed Effects Models to Fight Endogeneity in Panel Data and Difference–in–Difference Models</a><ul>
<li class="chapter" data-level="10.1" data-path="chp8.html"><a href="chp8.html#simpsons-paradox"><i class="fa fa-check"></i><b>10.1</b> Simpson’s Paradox</a></li>
<li class="chapter" data-level="10.2" data-path="chp8.html"><a href="chp8.html#figures-8.1-8.3"><i class="fa fa-check"></i><b>10.2</b> Figures 8.1-8.3</a></li>
<li class="chapter" data-level="10.3" data-path="chp8.html"><a href="chp8.html#one-way-fixed-effects-models"><i class="fa fa-check"></i><b>10.3</b> One-Way Fixed Effects Models</a><ul>
<li class="chapter" data-level="10.3.1" data-path="chp8.html"><a href="chp8.html#lsdv-approach"><i class="fa fa-check"></i><b>10.3.1</b> LSDV Approach</a></li>
<li class="chapter" data-level="10.3.2" data-path="chp8.html"><a href="chp8.html#f-test-for-significance-of-fixed-effects."><i class="fa fa-check"></i><b>10.3.2</b> <em>F</em>-test for significance of fixed effects.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="chp8.html"><a href="chp8.html#de-meaned-approach"><i class="fa fa-check"></i><b>10.4</b> De-Meaned approach</a><ul>
<li class="chapter" data-level="10.4.1" data-path="chp8.html"><a href="chp8.html#manually-de-mean"><i class="fa fa-check"></i><b>10.4.1</b> Manually De-Mean</a></li>
<li class="chapter" data-level="10.4.2" data-path="chp8.html"><a href="chp8.html#using-the-plm-package"><i class="fa fa-check"></i><b>10.4.2</b> Using the <code>plm</code> package</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="chp8.html"><a href="chp8.html#two-way-fixed-effects-models"><i class="fa fa-check"></i><b>10.5</b> Two-Way Fixed Effects Models</a><ul>
<li class="chapter" data-level="10.5.1" data-path="chp8.html"><a href="chp8.html#time-as-a-factor"><i class="fa fa-check"></i><b>10.5.1</b> Time as a factor</a></li>
<li class="chapter" data-level="10.5.2" data-path="chp8.html"><a href="chp8.html#effect-twoways"><i class="fa fa-check"></i><b>10.5.2</b> effect = “twoways”</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="chp8.html"><a href="chp8.html#difference-in-difference-models"><i class="fa fa-check"></i><b>10.6</b> Difference-in-Difference Models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chp9.html"><a href="chp9.html"><i class="fa fa-check"></i><b>11</b> Instrumental Variables: Using Exogenous Variation to Fight Endogeneity</a><ul>
<li class="chapter" data-level="11.1" data-path="chp9.html"><a href="chp9.html#stage-least-squares"><i class="fa fa-check"></i><b>11.1</b> 2 Stage Least Squares</a></li>
<li class="chapter" data-level="11.2" data-path="chp9.html"><a href="chp9.html#explanatory-power-of-the-instruments"><i class="fa fa-check"></i><b>11.2</b> Explanatory power of the instruments</a></li>
<li class="chapter" data-level="11.3" data-path="chp9.html"><a href="chp9.html#estimating-simultaneous-equation-model"><i class="fa fa-check"></i><b>11.3</b> Estimating Simultaneous Equation Model</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chp10.html"><a href="chp10.html"><i class="fa fa-check"></i><b>12</b> Experiments: Dealing with Real–World Challenges</a><ul>
<li class="chapter" data-level="12.1" data-path="chp10.html"><a href="chp10.html#assess-balance"><i class="fa fa-check"></i><b>12.1</b> Assess Balance</a></li>
<li class="chapter" data-level="12.2" data-path="chp10.html"><a href="chp10.html#estimate-itt-model"><i class="fa fa-check"></i><b>12.2</b> Estimate ITT Model</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chp11.html"><a href="chp11.html"><i class="fa fa-check"></i><b>13</b> Regression Discontinuity: Looking for Jumps in Data</a><ul>
<li class="chapter" data-level="13.1" data-path="chp11.html"><a href="chp11.html#same-slope"><i class="fa fa-check"></i><b>13.1</b> Same slope</a></li>
<li class="chapter" data-level="13.2" data-path="chp11.html"><a href="chp11.html#varying-slopes"><i class="fa fa-check"></i><b>13.2</b> Varying Slopes</a></li>
<li class="chapter" data-level="13.3" data-path="chp11.html"><a href="chp11.html#plot-rd-model"><i class="fa fa-check"></i><b>13.3</b> Plot RD Model</a></li>
<li class="chapter" data-level="13.4" data-path="chp11.html"><a href="chp11.html#rddtools-package"><i class="fa fa-check"></i><b>13.4</b> <code>rddtools</code> package</a><ul>
<li class="chapter" data-level="13.4.1" data-path="chp11.html"><a href="chp11.html#same-slope-1"><i class="fa fa-check"></i><b>13.4.1</b> Same slope</a></li>
<li class="chapter" data-level="13.4.2" data-path="chp11.html"><a href="chp11.html#varying-slopes-1"><i class="fa fa-check"></i><b>13.4.2</b> Varying Slopes</a></li>
<li class="chapter" data-level="13.4.3" data-path="chp11.html"><a href="chp11.html#scatter-plot"><i class="fa fa-check"></i><b>13.4.3</b> Scatter Plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="chp12.html"><a href="chp12.html"><i class="fa fa-check"></i><b>14</b> Dummy Dependent Variables</a><ul>
<li class="chapter" data-level="14.1" data-path="chp12.html"><a href="chp12.html#probit-estimation"><i class="fa fa-check"></i><b>14.1</b> Probit Estimation</a><ul>
<li class="chapter" data-level="14.1.1" data-path="chp12.html"><a href="chp12.html#eda"><i class="fa fa-check"></i><b>14.1.1</b> EDA</a></li>
<li class="chapter" data-level="14.1.2" data-path="chp12.html"><a href="chp12.html#estimate-the-model"><i class="fa fa-check"></i><b>14.1.2</b> Estimate the model</a></li>
<li class="chapter" data-level="14.1.3" data-path="chp12.html"><a href="chp12.html#estimated-effects"><i class="fa fa-check"></i><b>14.1.3</b> Estimated Effects</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="chp12.html"><a href="chp12.html#logit-estimation"><i class="fa fa-check"></i><b>14.2</b> Logit Estimation</a><ul>
<li class="chapter" data-level="14.2.1" data-path="chp12.html"><a href="chp12.html#discrete-differences"><i class="fa fa-check"></i><b>14.2.1</b> Discrete Differences</a></li>
<li class="chapter" data-level="14.2.2" data-path="chp12.html"><a href="chp12.html#marginal-effects-1"><i class="fa fa-check"></i><b>14.2.2</b> Marginal Effects</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="chp12.html"><a href="chp12.html#testing-hypotheses"><i class="fa fa-check"></i><b>14.3</b> Testing Hypotheses</a></li>
<li class="chapter" data-level="14.4" data-path="chp12.html"><a href="chp12.html#graphing-probit-and-logit-models"><i class="fa fa-check"></i><b>14.4</b> Graphing Probit and Logit Models</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="chp13.html"><a href="chp13.html"><i class="fa fa-check"></i><b>15</b> Time Series: Dealing with Stickiness over Time</a><ul>
<li class="chapter" data-level="15.1" data-path="chp13.html"><a href="chp13.html#time-series-objects-in-r"><i class="fa fa-check"></i><b>15.1</b> Time Series Objects in R</a></li>
<li class="chapter" data-level="15.2" data-path="chp13.html"><a href="chp13.html#detecting-autocorrelation"><i class="fa fa-check"></i><b>15.2</b> Detecting Autocorrelation</a></li>
<li class="chapter" data-level="15.3" data-path="chp13.html"><a href="chp13.html#correcting-autocorrelation"><i class="fa fa-check"></i><b>15.3</b> Correcting Autocorrelation</a><ul>
<li class="chapter" data-level="15.3.1" data-path="chp13.html"><a href="chp13.html#newey-west"><i class="fa fa-check"></i><b>15.3.1</b> Newey-West</a></li>
<li class="chapter" data-level="15.3.2" data-path="chp13.html"><a href="chp13.html#cochrane-orcutt"><i class="fa fa-check"></i><b>15.3.2</b> Cochrane-Orcutt</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="chp13.html"><a href="chp13.html#dynamic-models"><i class="fa fa-check"></i><b>15.4</b> Dynamic Models</a></li>
<li class="chapter" data-level="15.5" data-path="chp13.html"><a href="chp13.html#dickey-fuller-test"><i class="fa fa-check"></i><b>15.5</b> Dickey-Fuller Test</a></li>
<li class="chapter" data-level="15.6" data-path="chp13.html"><a href="chp13.html#first-differencing"><i class="fa fa-check"></i><b>15.6</b> First Differencing</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="chp14.html"><a href="chp14.html"><i class="fa fa-check"></i><b>16</b> Advanced OLS</a><ul>
<li class="chapter" data-level="16.1" data-path="chp14.html"><a href="chp14.html#derive-ols-estimator-matrix-form"><i class="fa fa-check"></i><b>16.1</b> Derive OLS estimator (Matrix Form)</a><ul>
<li class="chapter" data-level="16.1.1" data-path="chp14.html"><a href="chp14.html#example"><i class="fa fa-check"></i><b>16.1.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="chp14.html"><a href="chp14.html#gaussmarkov-theorem"><i class="fa fa-check"></i><b>16.2</b> Gauss–Markov Theorem</a><ul>
<li class="chapter" data-level="16.2.1" data-path="chp14.html"><a href="chp14.html#ols-estimator-is-linear"><i class="fa fa-check"></i><b>16.2.1</b> OLS estimator is linear</a></li>
<li class="chapter" data-level="16.2.2" data-path="chp14.html"><a href="chp14.html#ols-estimator-is-unbiased"><i class="fa fa-check"></i><b>16.2.2</b> OLS estimator is unbiased</a></li>
<li class="chapter" data-level="16.2.3" data-path="chp14.html"><a href="chp14.html#variance-covariance-is-a-minimum"><i class="fa fa-check"></i><b>16.2.3</b> Variance-Covariance is a minimum</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="chp4.html"><a href="chp4.html#probability-distributions-in-r"><i class="fa fa-check"></i><b>16.3</b> Probability Distributions in R</a><ul>
<li class="chapter" data-level="16.3.1" data-path="chp14.html"><a href="chp14.html#obtaining-critical-statistics"><i class="fa fa-check"></i><b>16.3.1</b> Obtaining Critical Statistics</a></li>
<li class="chapter" data-level="16.3.2" data-path="cph3.html"><a href="cph3.html#generating-random-numbers"><i class="fa fa-check"></i><b>16.3.2</b> Generating Random Numbers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="chp15.html"><a href="chp15.html"><i class="fa fa-check"></i><b>17</b> Advanced Panel Data</a><ul>
<li class="chapter" data-level="17.1" data-path="chp15.html"><a href="chp15.html#the-data"><i class="fa fa-check"></i><b>17.1</b> The Data</a></li>
<li class="chapter" data-level="17.2" data-path="chp15.html"><a href="chp15.html#variation-within-units"><i class="fa fa-check"></i><b>17.2</b> Variation within Units</a></li>
<li class="chapter" data-level="17.3" data-path="chp15.html"><a href="chp15.html#two-way-fixed-effects-model"><i class="fa fa-check"></i><b>17.3</b> Two-Way Fixed Effects Model</a></li>
<li class="chapter" data-level="17.4" data-path="chp15.html"><a href="chp15.html#testing-for-autocorrelation"><i class="fa fa-check"></i><b>17.4</b> Testing for autocorrelation</a></li>
<li class="chapter" data-level="17.5" data-path="chp15.html"><a href="chp15.html#estimating-hatrho"><i class="fa fa-check"></i><b>17.5</b> Estimating <span class="math inline">\(\hat\rho\)</span></a></li>
<li class="chapter" data-level="17.6" data-path="chp15.html"><a href="chp15.html#estimate-a-rho-transformed-model"><i class="fa fa-check"></i><b>17.6</b> Estimate a <span class="math inline">\(\rho\)</span>-Transformed Model</a></li>
<li class="chapter" data-level="17.7" data-path="chp15.html"><a href="chp15.html#lagged-dependent-variable-panel-data-model"><i class="fa fa-check"></i><b>17.7</b> Lagged Dependent Variable Panel Data Model</a></li>
<li class="chapter" data-level="17.8" data-path="chp15.html"><a href="chp15.html#random-effects-model"><i class="fa fa-check"></i><b>17.8</b> Random Effects Model</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Companion to <em>Real Econometrics</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chp2" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Stats in the Wild: Good Data Practices</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<p>I will introduce some additional R commands and packages through reproducing Table 2.1, Table 2.2, Table 2.5, and Figure 2.3. In addition, we will go through the <em>Computing Corner</em>.</p>
</div>
<div id="table-and-figure-reproduction" class="section level2">
<h2><span class="header-section-number">4.2</span> Table and Figure Reproduction</h2>
<div id="table-2.1" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Table 2.1</h3>
<p>Since we saved the data frame we created in Chapter 1 as donuts.RData, we will <code>load</code> the file into global environment. We are only interested in the summary statistics for Weight and Donuts. We can get a basic set of summary statistics by calling <code>summary</code> on the data frame. But, <code>stargazer</code> from
the stargazer package. The stargazer produces well formatted tables in LaTex code, HTML code, and ASCII text.</p>
<p>We will make use of the pipe operator from the <code>magrittr</code> package (also part of the <code>tidyverse</code>), as well. The pipe operator <code>%&gt;%</code> (ctr-shift-m shortcut in R Studio) allows for more intuitive reading of code especially when nesting commands inside of each other. Take a simple example of finding calling the <code>str</code> command on a data frame, <code>df</code>. Without the pipe operator <code>%&gt;%</code>, we would call the command like this <code>str(df)</code> and you might read this aloud alike this find the structure of df. With the pipe operator, call the command like this <code>df %&gt;% str()</code>. Read aloud it might be something like this “take the <code>df</code> data and find its structure.” The pipe operator really shines when functions are nested together, as we shall see below.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="chp2.html#cb20-1"></a><span class="kw">load</span>(<span class="st">&quot;donuts.RData&quot;</span>)</span>
<span id="cb20-2"><a href="chp2.html#cb20-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb20-3"><a href="chp2.html#cb20-3"></a><span class="kw">library</span>(stargazer)</span>
<span id="cb20-4"><a href="chp2.html#cb20-4"></a>donuts <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-5"><a href="chp2.html#cb20-5"></a><span class="st">  </span><span class="co"># choose and rename the columns</span></span>
<span id="cb20-6"><a href="chp2.html#cb20-6"></a><span class="st">  </span><span class="kw">select</span>(<span class="st">&quot;Weight&quot;</span> =<span class="st"> </span>weight, <span class="st">&quot;Donuts&quot;</span> =<span class="st"> </span>donuts_per_week) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-7"><a href="chp2.html#cb20-7"></a><span class="st">  </span><span class="co"># stargazer doesn&#39;t play nice with tibbles so we coerce donuts to a data frame</span></span>
<span id="cb20-8"><a href="chp2.html#cb20-8"></a><span class="st">  </span>as.data.frame <span class="op">%&gt;%</span></span>
<span id="cb20-9"><a href="chp2.html#cb20-9"></a><span class="st">  </span><span class="co"># tell stargazer to produce an ASCII text version of the table</span></span>
<span id="cb20-10"><a href="chp2.html#cb20-10"></a><span class="st">  </span><span class="kw">stargazer</span>(<span class="dt">type =</span> <span class="st">&quot;text&quot;</span>, </span>
<span id="cb20-11"><a href="chp2.html#cb20-11"></a>              <span class="dt">title =</span> <span class="st">&quot;Table 2.1&quot;</span>, </span>
<span id="cb20-12"><a href="chp2.html#cb20-12"></a>  <span class="co"># omit the default 1st and 3rd quartiles</span></span>
<span id="cb20-13"><a href="chp2.html#cb20-13"></a>              <span class="dt">omit.summary.stat =</span> <span class="kw">c</span>(<span class="st">&quot;p25&quot;</span>, <span class="st">&quot;p75&quot;</span>))</span></code></pre></div>
<pre><code>
Table 2.1
=====================================
Statistic N   Mean   St. Dev. Min Max
-------------------------------------
Weight    13 172.000  76.200  70  310
Donuts    13  5.450   6.750    0  20 
-------------------------------------</code></pre>
<p>We can return similar summary statistics with <code>descr</code> from the <code>summarytools</code> package.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="chp2.html#cb22-1"></a>donuts <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-2"><a href="chp2.html#cb22-2"></a><span class="st">  </span><span class="co"># choose the variables we&#39;d like to summarize</span></span>
<span id="cb22-3"><a href="chp2.html#cb22-3"></a><span class="st">  </span><span class="co"># here we choose &quot;away&quot; from observation number</span></span>
<span id="cb22-4"><a href="chp2.html#cb22-4"></a><span class="st">  </span><span class="co"># descr will ignore non-numeric vectors</span></span>
<span id="cb22-5"><a href="chp2.html#cb22-5"></a><span class="st">  </span><span class="kw">select</span>(<span class="dt">Weight =</span> weight, <span class="dt">Donuts =</span> donuts_per_week) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-6"><a href="chp2.html#cb22-6"></a><span class="st">  </span>summarytools<span class="op">::</span><span class="kw">descr</span>(<span class="dt">stats =</span> <span class="kw">c</span>(<span class="st">&quot;n.valid&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;sd&quot;</span>, <span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>),</span>
<span id="cb22-7"><a href="chp2.html#cb22-7"></a>                      <span class="dt">round.digits =</span> <span class="dv">3</span>,</span>
<span id="cb22-8"><a href="chp2.html#cb22-8"></a>                      <span class="dt">transpose =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-9"><a href="chp2.html#cb22-9"></a><span class="st">  </span>DT<span class="op">::</span><span class="kw">datatable</span>(<span class="dt">caption =</span> htmltools<span class="op">::</span>tags<span class="op">$</span><span class="kw">caption</span>(</span>
<span id="cb22-10"><a href="chp2.html#cb22-10"></a>                <span class="dt">style =</span> <span class="st">&quot;caption-side: bottom; text-align: left;&quot;</span>,</span>
<span id="cb22-11"><a href="chp2.html#cb22-11"></a>                <span class="st">&quot;Table 2.1&quot;</span>),</span>
<span id="cb22-12"><a href="chp2.html#cb22-12"></a>                <span class="dt">class =</span> <span class="st">&quot;cell-border stripe&quot;</span>,</span>
<span id="cb22-13"><a href="chp2.html#cb22-13"></a>                <span class="dt">colnames =</span> <span class="kw">c</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;St. Dev.&quot;</span>, <span class="st">&quot;Min&quot;</span>, <span class="st">&quot;Max&quot;</span>),</span>
<span id="cb22-14"><a href="chp2.html#cb22-14"></a>                <span class="dt">options =</span> <span class="kw">list</span>(<span class="dt">dom =</span> <span class="st">&quot;t&quot;</span>))</span></code></pre></div>
<div id="htmlwidget-fd617df5506e2858ab81" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-fd617df5506e2858ab81">{"x":{"filter":"none","caption":"<caption style=\"caption-side: bottom; text-align: left;\">Table 2.1<\/caption>","data":[["Donuts","Weight"],[13,13],[5.44615384615385,171.846153846154],[6.74955126713564,76.1553742400431],[0,70],[20,310]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>N<\/th>\n      <th>Mean<\/th>\n      <th>St. Dev.<\/th>\n      <th>Min<\/th>\n      <th>Max<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="table-2.2" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Table 2.2</h3>
<p>To reproduce Table 2.2 we will need to add a variable named male which will take on the value 1 for each observation in the data that represents a male and a 0 otherwise.</p>
<p><span class="math display">\[male = 
\begin{cases}
1 &amp; \text{if observation is male} \\
0 &amp; \text{if observation is female}
\end{cases}\]</span></p>
<p>We will make use of <code>mutate()</code> from the <code>dplyr</code> package. We use <code>mutate()</code> when we want to create a new variable from existing variables in the data frame.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="chp2.html#cb23-1"></a><span class="kw">load</span>(<span class="st">&quot;donuts.RData&quot;</span>)</span>
<span id="cb23-2"><a href="chp2.html#cb23-2"></a>donuts<span class="op">$</span>name <span class="co"># this syntax reads &quot;print the variable name from the donuts data frame&quot;.</span></span></code></pre></div>
<pre><code> [1] &quot;Homer&quot;             &quot;Marge&quot;             &quot;Lisa&quot;             
 [4] &quot;Bart&quot;              &quot;Comic Book Guy&quot;    &quot;Mr. Burns&quot;        
 [7] &quot;Smithers&quot;          &quot;Chief Wiggum&quot;      &quot;Principle Skinner&quot;
[10] &quot;Rev. Lovejoy&quot;      &quot;Ned Flanders&quot;      &quot;Patty&quot;            
[13] &quot;Selma&quot;            </code></pre>
<p>The square brackets <code>[]</code> indicate the position of each observation in the vector. So, in position <code>[9]</code> is Principle Skinner.</p>
<p>Making use of donuts$name we see that the observations 1, 4, 5, 6, 7, 8, 9, 10, 11 are male and observations 2, 3, 12, 13 are not. We add the variable male to the donuts data frame as follows:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="chp2.html#cb25-1"></a>donuts<span class="op">$</span>male &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p>Call <code>table</code> to create a rudimentary version of Table 2.2</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="chp2.html#cb26-1"></a>donuts<span class="op">$</span>male <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-2"><a href="chp2.html#cb26-2"></a><span class="st">  </span><span class="kw">table</span>()</span></code></pre></div>
<pre><code>.
0 1 
4 9 </code></pre>
</div>
<div id="table-2.5" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Table 2.5</h3>
<p>To reproduce Table 2.5 we must first retrieve the data. We will retrieve the data directly from the agencies responsible for their collection. You can retrieve the data as a comma-separated values (<code>csv</code>) file. A <code>csv</code> file is a plain text file in which the data are stored in a tabular format with values separated by a comma.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<p>The crime data can be found on the U.S. Department of Justice Federal Bureau of Investigation Uniform Crime Reporting Statistics <a href="https://www.ucrdatatool.gov/">website</a>. The single parent, urban, and poverty data can found on the U.S. Census <a href="https://www.census.gov/">website</a>.</p>
<p>An investigation of the <code>CrimeOneYearofData.csv</code> file shows that there is meta information contained in the file along with the data. We could open the csv file in Excel and edit it to remove the information or we could read it directly into R using <code>read_csv</code> from the <code>readr</code> package<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a> with options to ignore the meta information. The readr package has many advantages over the base R read functions, see <code>vignette("readr")</code> for more information.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a></p>
<p>We can view the file by clicking on it in the Files tab of the pane in the lower right corner. Choose the view file option and a new tab will open in the source pane.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> We see tat the first nine rows are either blank or contain information about the data and that rows 63 to 183 contain footnotes and other additional information about the data. The names of the variables are in row ten of the csv file; so, we will skip the first nine rows using the argument <code>skip</code>. We will choose the rows that contain the states and Washington, D.C., with the <code>n_max</code> option.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="chp2.html#cb28-1"></a>crime_one_year_of_data &lt;-<span class="st"> </span></span>
<span id="cb28-2"><a href="chp2.html#cb28-2"></a><span class="st">  </span><span class="co"># read the data from its location</span></span>
<span id="cb28-3"><a href="chp2.html#cb28-3"></a><span class="st">  </span><span class="kw">read_csv</span>(<span class="st">&quot;Data/CrimeOneYearofData.csv&quot;</span>, </span>
<span id="cb28-4"><a href="chp2.html#cb28-4"></a>                               <span class="dt">skip =</span> <span class="dv">9</span>, <span class="co"># start at row 10</span></span>
<span id="cb28-5"><a href="chp2.html#cb28-5"></a>                               <span class="dt">n_max =</span> <span class="dv">51</span>) <span class="co"># use only 51 records</span></span>
<span id="cb28-6"><a href="chp2.html#cb28-6"></a>crime_one_year_of_data</span></code></pre></div>
<pre><code># A tibble: 51 x 9
   State Population `Violent Crime ~ `Murder and non~ `Legacy rape ra~
   &lt;chr&gt;      &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
 1 Alab~    4708708             450.              6.8             31.9
 2 Alas~     698473             633.              3.1             73.4
 3 Ariz~    6595778             426.              5.8             34.6
 4 Arka~    2889450             516.              6.2             47.7
 5 Cali~   36961664             473.              5.3             23.6
 6 Colo~    5024748             339.              3.2             45.2
 7 Conn~    3518288             301.              3               18.7
 8 Dela~     885122             645.              4.6             44.6
 9 Dist~     599657            1349.             24.2             25  
10 Flor~   18537969             612.              5.5             29.7
# ... with 41 more rows, and 4 more variables: `Revised rape rate /2` &lt;lgl&gt;,
#   `Robbery rate` &lt;dbl&gt;, `Aggravated assault rate` &lt;dbl&gt;, X9 &lt;chr&gt;</code></pre>
<p>Similar to <code>ggplot</code> being based on the grammar of graphics, <code>dplyr</code> is a grammar of data manipulation. dplyr consists of a set of “verbs” to help solve common data manipulation problems. To learn more about dplyr read <code>vignette("dplyr")</code>, visit <a href="https://dplyr.tidyverse.org/">dplyr</a>, or for a good introduction visit the <a href="https://r4ds.had.co.nz/transform.html">data import chapter</a> in <em>R for Data Science</em>.</p>
<p>Using <code>glimpse</code> from dplyr, we see that we have a tibble with 51 observations and 9 variables. <code>glimpse</code> is similar to <code>str</code>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="chp2.html#cb30-1"></a>crime_one_year_of_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-2"><a href="chp2.html#cb30-2"></a><span class="st">  </span>glimpse</span></code></pre></div>
<pre><code>Rows: 51
Columns: 9
$ State                                       &lt;chr&gt; &quot;Alabama&quot;, &quot;Alaska&quot;, &quot;A...
$ Population                                  &lt;dbl&gt; 4708708, 698473, 659577...
$ `Violent Crime rate`                        &lt;dbl&gt; 450, 633, 426, 516, 473...
$ `Murder and nonnegligent manslaughter rate` &lt;dbl&gt; 6.8, 3.1, 5.8, 6.2, 5.3...
$ `Legacy rape rate /1`                       &lt;dbl&gt; 31.9, 73.4, 34.6, 47.7,...
$ `Revised rape rate /2`                      &lt;lgl&gt; NA, NA, NA, NA, NA, NA,...
$ `Robbery rate`                              &lt;dbl&gt; 133.1, 93.6, 124.3, 89....
$ `Aggravated assault rate`                   &lt;dbl&gt; 278.3, 463.2, 261.8, 37...
$ X9                                          &lt;chr&gt; NA, NA, NA, NA, NA, NA,...</code></pre>
<p>We see that State is a character vector and Violent Crime Rate is a numeric vector. Looking at the names of the variables we can see they do not adhere to the stylistic guidelines discussed above. The State variable begins with a capital letter and the Violent Crime Variable has capital letters and spaces in its name (the spaces are why you see the tick mark “`” before and after the name). The state names are spelled out, but to reproduce Figure 2.3 we need to change those to two-letter abbreviations.</p>
<p>To bring the names into stylistic guidelines we can use <code>clean_names</code> from the <code>janitor</code> package, <code>snake case</code> is the default conversion. Note, the versatility of the <code>%&gt;%</code> operator. If we did not use the <code>%&gt;%</code> operator, the code would have been written as <code>glimpse(crime_one_year_of_data &lt;- clean_names(crime_one_year_of_data))</code></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="chp2.html#cb32-1"></a><span class="kw">library</span>(janitor)</span>
<span id="cb32-2"><a href="chp2.html#cb32-2"></a>crime_one_year_of_data &lt;-<span class="st"> </span></span>
<span id="cb32-3"><a href="chp2.html#cb32-3"></a><span class="st">  </span>crime_one_year_of_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-4"><a href="chp2.html#cb32-4"></a><span class="st">  </span><span class="kw">clean_names</span>() </span>
<span id="cb32-5"><a href="chp2.html#cb32-5"></a>crime_one_year_of_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-6"><a href="chp2.html#cb32-6"></a><span class="st">  </span>glimpse</span></code></pre></div>
<pre><code>Rows: 51
Columns: 9
$ state                                     &lt;chr&gt; &quot;Alabama&quot;, &quot;Alaska&quot;, &quot;Ari...
$ population                                &lt;dbl&gt; 4708708, 698473, 6595778,...
$ violent_crime_rate                        &lt;dbl&gt; 450, 633, 426, 516, 473, ...
$ murder_and_nonnegligent_manslaughter_rate &lt;dbl&gt; 6.8, 3.1, 5.8, 6.2, 5.3, ...
$ legacy_rape_rate_1                        &lt;dbl&gt; 31.9, 73.4, 34.6, 47.7, 2...
$ revised_rape_rate_2                       &lt;lgl&gt; NA, NA, NA, NA, NA, NA, N...
$ robbery_rate                              &lt;dbl&gt; 133.1, 93.6, 124.3, 89.2,...
$ aggravated_assault_rate                   &lt;dbl&gt; 278.3, 463.2, 261.8, 372....
$ x9                                        &lt;chr&gt; NA, NA, NA, NA, NA, NA, N...</code></pre>
<p>The names of the variables follow good practice.</p>
<p>We will read the other data in a similar fashion.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="chp2.html#cb34-1"></a><span class="co"># Source: U.S. Census Bureau, 2009 American Community Survey, Table C23008</span></span>
<span id="cb34-2"><a href="chp2.html#cb34-2"></a>acs_<span class="dv">09</span>_1yr_c23008_with_ann &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;Data/ACS_09_1YR_C23008_with_ann.csv&quot;</span>, </span>
<span id="cb34-3"><a href="chp2.html#cb34-3"></a>    <span class="dt">skip =</span> <span class="dv">1</span>,</span>
<span id="cb34-4"><a href="chp2.html#cb34-4"></a>    <span class="dt">n_max =</span> <span class="dv">51</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-5"><a href="chp2.html#cb34-5"></a><span class="st">  </span><span class="kw">clean_names</span>() </span>
<span id="cb34-6"><a href="chp2.html#cb34-6"></a></span>
<span id="cb34-7"><a href="chp2.html#cb34-7"></a>acs_<span class="dv">09</span>_1yr_c23008_with_ann</span></code></pre></div>
<pre><code># A tibble: 51 x 8
   id    id2   geography estimate_total estimate_under_~ estimate_under_~
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;              &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
 1 0400~ 01    Alabama          1059528           357122           141977
 2 0400~ 02    Alaska            174634            61489            20676
 3 0400~ 04    Arizona          1645424           591862           226729
 4 0400~ 05    Arkansas          670246           231937            91509
 5 0400~ 06    Californ~        8980424          3122142          1061375
 6 0400~ 08    Colorado         1177386           419960           116316
 7 0400~ 09    Connecti~         780490           244527            73174
 8 0400~ 10    Delaware          195738            67400            26102
 9 0400~ 11    District~         106701            40852            20741
10 0400~ 12    Florida          3853587          1311773           507149
# ... with 41 more rows, and 2 more variables: estimate_6_to_17_years &lt;dbl&gt;,
#   estimate_6_to_17_years_living_with_one_parent &lt;dbl&gt;</code></pre>
<p>To create the percentage of children with single parents, add those under 6 living with one parent to those between 6 and 17 living with one parent and divide by the estimated total. We create the new variable with the <code>mutate</code> verb from dplyr and <code>select</code> geography as state and percent with single parents into a new data frame.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="chp2.html#cb36-1"></a>single_parents &lt;-<span class="st"> </span></span>
<span id="cb36-2"><a href="chp2.html#cb36-2"></a>acs_<span class="dv">09</span>_1yr_c23008_with_ann <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-3"><a href="chp2.html#cb36-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent_single_parents =</span> </span>
<span id="cb36-4"><a href="chp2.html#cb36-4"></a>           (estimate_under_<span class="dv">6</span>_years_living_with_one_parent <span class="op">+</span><span class="st"> </span></span>
<span id="cb36-5"><a href="chp2.html#cb36-5"></a><span class="st">              </span>estimate_<span class="dv">6</span>_to_<span class="dv">17</span>_years_living_with_one_parent) <span class="op">/</span><span class="st"> </span></span>
<span id="cb36-6"><a href="chp2.html#cb36-6"></a><span class="st">           </span>estimate_total) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-7"><a href="chp2.html#cb36-7"></a><span class="st">  </span><span class="kw">select</span>(<span class="dt">state =</span> geography, percent_single_parents) </span>
<span id="cb36-8"><a href="chp2.html#cb36-8"></a></span>
<span id="cb36-9"><a href="chp2.html#cb36-9"></a>single_parents</span></code></pre></div>
<pre><code># A tibble: 51 x 2
   state                percent_single_parents
   &lt;chr&gt;                                 &lt;dbl&gt;
 1 Alabama                               0.389
 2 Alaska                                0.303
 3 Arizona                               0.365
 4 Arkansas                              0.378
 5 California                            0.324
 6 Colorado                              0.280
 7 Connecticut                           0.299
 8 Delaware                              0.376
 9 District of Columbia                  0.608
10 Florida                               0.377
# ... with 41 more rows</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="chp2.html#cb38-1"></a><span class="co"># Source: U.S. Census Bureau, 2009 American Community Survey, Table S1701</span></span>
<span id="cb38-2"><a href="chp2.html#cb38-2"></a>acs_<span class="dv">09</span>_1yr_s1701_with_ann &lt;-<span class="st"> </span></span>
<span id="cb38-3"><a href="chp2.html#cb38-3"></a><span class="st">  </span><span class="kw">read_csv</span>(<span class="st">&quot;Data/ACS_09_1YR_S1701_with_ann.csv&quot;</span>, <span class="dt">skip =</span> <span class="dv">1</span>, <span class="dt">n_max =</span> <span class="dv">51</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-4"><a href="chp2.html#cb38-4"></a><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb38-5"><a href="chp2.html#cb38-5"></a><span class="st">  </span><span class="kw">select</span>(<span class="st">&quot;state&quot;</span> =<span class="st"> </span>geography, <span class="co"># directly name the variables when selected</span></span>
<span id="cb38-6"><a href="chp2.html#cb38-6"></a>         <span class="st">&quot;percent_poverty&quot;</span> =</span>
<span id="cb38-7"><a href="chp2.html#cb38-7"></a><span class="st">           </span>percent_below_poverty_level_estimate_population_for_whom_poverty_status_is_determined)</span>
<span id="cb38-8"><a href="chp2.html#cb38-8"></a></span>
<span id="cb38-9"><a href="chp2.html#cb38-9"></a>acs_<span class="dv">09</span>_1yr_s1701_with_ann</span></code></pre></div>
<pre><code># A tibble: 51 x 2
   state                percent_poverty
   &lt;chr&gt;                          &lt;dbl&gt;
 1 Alabama                         17.5
 2 Alaska                           9  
 3 Arizona                         16.5
 4 Arkansas                        18.8
 5 California                      14.2
 6 Colorado                        12.9
 7 Connecticut                      9.4
 8 Delaware                        10.8
 9 District of Columbia            18.4
10 Florida                         14.9
# ... with 41 more rows</code></pre>
<p>To create the percent urban in 2009, we need to interpolate using the 2000 and 2010 censuses. After reading each set of data we will combine them into one data frame using <code>right_join</code> from the <code>dplyr</code> package. More on that below. First, let’s read the data.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="chp2.html#cb40-1"></a><span class="co"># Source: U.S. Census Bureau, Table P002</span></span>
<span id="cb40-2"><a href="chp2.html#cb40-2"></a>dec_<span class="dv">00</span>_sf1_p002_with_ann &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;Data/DEC_00_SF1_P002_with_ann.csv&quot;</span>, <span class="dt">skip =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-3"><a href="chp2.html#cb40-3"></a><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span></span>
<span id="cb40-4"><a href="chp2.html#cb40-4"></a><span class="st">  </span><span class="kw">select</span>(<span class="dt">state =</span> geography, <span class="dt">total_00 =</span> total , <span class="dt">urban_00 =</span> urban)</span>
<span id="cb40-5"><a href="chp2.html#cb40-5"></a></span>
<span id="cb40-6"><a href="chp2.html#cb40-6"></a>dec_<span class="dv">00</span>_sf1_p002_with_ann</span></code></pre></div>
<pre><code># A tibble: 51 x 3
   state                total_00 urban_00
   &lt;chr&gt;                   &lt;dbl&gt;    &lt;dbl&gt;
 1 Alabama               4447100  2465673
 2 Alaska                 626932   411257
 3 Arizona               5130632  4523535
 4 Arkansas              2673400  1404179
 5 California           33871648 31989663
 6 Colorado              4301261  3633185
 7 Connecticut           3405565  2988059
 8 Delaware               783600   627758
 9 District of Columbia   572059   572059
10 Florida              15982378 14270020
# ... with 41 more rows</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="chp2.html#cb42-1"></a><span class="co"># Source: U.S. Census Bureau, Table H2</span></span>
<span id="cb42-2"><a href="chp2.html#cb42-2"></a>dec_<span class="dv">10</span>_sf1_p2_with_ann &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;Data/DEC_10_SF1_P2_with_ann.csv&quot;</span>, <span class="dt">skip =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-3"><a href="chp2.html#cb42-3"></a><span class="st">  </span><span class="kw">clean_names</span>() <span class="op">%&gt;%</span></span>
<span id="cb42-4"><a href="chp2.html#cb42-4"></a><span class="st">  </span><span class="kw">select</span>(<span class="st">&quot;state&quot;</span> =<span class="st"> </span>geography, <span class="st">&quot;total_10&quot;</span> =<span class="st"> </span>total , <span class="st">&quot;urban_10&quot;</span> =<span class="st"> </span>urban) </span>
<span id="cb42-5"><a href="chp2.html#cb42-5"></a></span>
<span id="cb42-6"><a href="chp2.html#cb42-6"></a>dec_<span class="dv">10</span>_sf1_p2_with_ann</span></code></pre></div>
<pre><code># A tibble: 51 x 3
   state                total_10         urban_10
   &lt;chr&gt;                &lt;chr&gt;               &lt;dbl&gt;
 1 Alabama              4779736(r38235)   2821804
 2 Alaska               710231(r38823)     468893
 3 Arizona              6392017           5740659
 4 Arkansas             2915918(r39193)   1637589
 5 California           37253956         35373606
 6 Colorado             5029196           4332761
 7 Connecticut          3574097           3144942
 8 Delaware             897934             747949
 9 District of Columbia 601723(r39494)     601723
10 Florida              18801310(r40184) 17139844
# ... with 41 more rows</code></pre>
<p>Note the message returned by <code>read_csc</code> telling us how it parsed each column into an atomic vector type. In particular, note that <code>Total</code> in the 2010 data was parsed as a character vector. This means that there is at least one observation that includes characters. In fact, we can see at least 3 of the observations include parenthetical notes.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="chp2.html#cb44-1"></a>dec_<span class="dv">10</span>_sf1_p2_with_ann <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb44-2"><a href="chp2.html#cb44-2"></a><span class="st">  </span><span class="co"># the pull call returns the vector pulled as a vector</span></span>
<span id="cb44-3"><a href="chp2.html#cb44-3"></a><span class="st">  </span><span class="kw">pull</span>(total_<span class="dv">10</span>)</span></code></pre></div>
<pre><code> [1] &quot;4779736(r38235)&quot;  &quot;710231(r38823)&quot;   &quot;6392017&quot;          &quot;2915918(r39193)&quot; 
 [5] &quot;37253956&quot;         &quot;5029196&quot;          &quot;3574097&quot;          &quot;897934&quot;          
 [9] &quot;601723(r39494)&quot;   &quot;18801310(r40184)&quot; &quot;9687653(r41102)&quot;  &quot;1360301&quot;         
[13] &quot;1567582(r41542)&quot;  &quot;12830632&quot;         &quot;6483802&quot;          &quot;3046355&quot;         
[17] &quot;2853118&quot;          &quot;4339367&quot;          &quot;4533372&quot;          &quot;1328361&quot;         
[21] &quot;5773552(r42264)&quot;  &quot;6547629&quot;          &quot;9883640(r45127)&quot;  &quot;5303925&quot;         
[25] &quot;2967297&quot;          &quot;5988927&quot;          &quot;989415&quot;           &quot;1826341&quot;         
[29] &quot;2700551&quot;          &quot;1316470&quot;          &quot;8791894(r46246)&quot;  &quot;2059179(r46748)&quot; 
[33] &quot;19378102&quot;         &quot;9535483&quot;          &quot;672591&quot;           &quot;11536504&quot;        
[37] &quot;3751351&quot;          &quot;3831074&quot;          &quot;12702379&quot;         &quot;1052567&quot;         
[41] &quot;4625364&quot;          &quot;814180(r48166)&quot;   &quot;6346105&quot;          &quot;25145561(r48514)&quot;
[45] &quot;2763885&quot;          &quot;625741&quot;           &quot;8001024&quot;          &quot;6724540&quot;         
[49] &quot;1852994&quot;          &quot;5686986&quot;          &quot;563626&quot;          </code></pre>
<p>We have confirmed that undesirable string has the same form in each position it exists. We must remove those comments and coerce the variable to numeric to proceed. We can determine how many instances of these comments occur using <code>str_detect</code> from the <code>stringr</code> package. <code>str_detect</code> will return a logical vector, so we need only sum the vector to count the number of times this occurs. We need to remove the parentheses and what is between them.</p>
<p>When calling <code>sum</code> on a logical vector, TRUE is treated as 1 and FALSE as 0, so summing the vector “counts” the number of TRUE occurrences. A regular expression, <em>regex</em> or <em>regexp</em>, is a sequence of characters that define a search pattern, to learn more visit <a href="https://regexr.com/">regexr.com</a>. The pattern we are looking for here is given by “\(.+\)”. Since the parenthesis is a special character, it must be escaped with \, the <code>.</code> is a wild card, the <code>+</code> means 1 or more occurrence of the wild card, so the <code>.+</code> means find anything that appears 1 or more times. So the expression can be read as start with ( find anything which occurs one or more times and end with ).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="chp2.html#cb46-1"></a><span class="kw">str_detect</span>(dec_<span class="dv">10</span>_sf1_p2_with_ann<span class="op">$</span>total_<span class="dv">10</span>, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">(.+</span><span class="ch">\\</span><span class="st">)&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-2"><a href="chp2.html#cb46-2"></a><span class="st">  </span><span class="kw">sum</span>()</span></code></pre></div>
<pre><code>[1] 13</code></pre>
<p>The pattern occurs 13 times. We need to remove the string and coerce the character vector to a numeric vector. <code>str_replace_all</code> will remove all occurrences of the string. <code>as.numeric</code> will coerce the character vector to a numeric vector. We will make use of the “two-way” pipe operator <code>%&lt;&gt;%</code> in each function call. This operator takes the left hand side passes it to to the function and returns the result back to the original vector effectively overwriting it.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="chp2.html#cb48-1"></a><span class="co"># the  %&lt;&gt;% operator is a &quot;two way&quot; pipe that sends the result back to the left hand side.</span></span>
<span id="cb48-2"><a href="chp2.html#cb48-2"></a>dec_<span class="dv">10</span>_sf1_p2_with_ann<span class="op">$</span>total_<span class="dv">10</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">str_replace_all</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">(.+</span><span class="ch">\\</span><span class="st">)&quot;</span>, <span class="st">&quot;&quot;</span>) <span class="co"># &quot;&quot; replaces the string with blank</span></span>
<span id="cb48-3"><a href="chp2.html#cb48-3"></a>dec_<span class="dv">10</span>_sf1_p2_with_ann<span class="op">$</span>total_<span class="dv">10</span> <span class="op">%&lt;&gt;%</span><span class="st"> </span><span class="kw">as.numeric</span>()</span>
<span id="cb48-4"><a href="chp2.html#cb48-4"></a>dec_<span class="dv">10</span>_sf1_p2_with_ann <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-5"><a href="chp2.html#cb48-5"></a><span class="st"> </span><span class="kw">glimpse</span>()</span></code></pre></div>
<pre><code>Rows: 51
Columns: 3
$ state    &lt;chr&gt; &quot;Alabama&quot;, &quot;Alaska&quot;, &quot;Arizona&quot;, &quot;Arkansas&quot;, &quot;California&quot;, ...
$ total_10 &lt;dbl&gt; 4779736, 710231, 6392017, 2915918, 37253956, 5029196, 3574...
$ urban_10 &lt;dbl&gt; 2821804, 468893, 5740659, 1637589, 35373606, 4332761, 3144...</code></pre>
<p>We see that <code>total_10</code> is now a numeric vector.</p>
<p>We can now combine the two data frames using <code>right_join</code> from the dplyr package. Since each data frame contains <code>state</code>, <code>right_join</code> will join the columns from the 2010 census to the end (right) of the 2000 census matching observations by state. We will assign the result to percent_urban.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="chp2.html#cb50-1"></a>urban &lt;-<span class="st"> </span>dec_<span class="dv">00</span>_sf1_p002_with_ann <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb50-2"><a href="chp2.html#cb50-2"></a><span class="st">  </span><span class="kw">right_join</span>(dec_<span class="dv">10</span>_sf1_p2_with_ann)</span>
<span id="cb50-3"><a href="chp2.html#cb50-3"></a></span>
<span id="cb50-4"><a href="chp2.html#cb50-4"></a>urban </span></code></pre></div>
<pre><code># A tibble: 51 x 5
   state                total_00 urban_00 total_10 urban_10
   &lt;chr&gt;                   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1 Alabama               4447100  2465673  4779736  2821804
 2 Alaska                 626932   411257   710231   468893
 3 Arizona               5130632  4523535  6392017  5740659
 4 Arkansas              2673400  1404179  2915918  1637589
 5 California           33871648 31989663 37253956 35373606
 6 Colorado              4301261  3633185  5029196  4332761
 7 Connecticut           3405565  2988059  3574097  3144942
 8 Delaware               783600   627758   897934   747949
 9 District of Columbia   572059   572059   601723   601723
10 Florida              15982378 14270020 18801310 17139844
# ... with 41 more rows</code></pre>
<p>We can, now, interpolate the 2009 observations from the 2000 and 2010 observations. Since 2009 is nine tenths of the distance to 2010 from 2000, we will add 9/10 of the difference between the two observations to the 2000 observation.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="chp2.html#cb52-1"></a>urban <span class="op">%&lt;&gt;%</span><span class="st"> </span></span>
<span id="cb52-2"><a href="chp2.html#cb52-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent_urban =</span> (.<span class="dv">9</span> <span class="op">*</span><span class="st"> </span>(urban_<span class="dv">10</span> <span class="op">-</span><span class="st"> </span>urban_<span class="dv">00</span>) <span class="op">+</span><span class="st"> </span>urban_<span class="dv">00</span>) <span class="op">/</span><span class="st"> </span></span>
<span id="cb52-3"><a href="chp2.html#cb52-3"></a><span class="st">           </span>(.<span class="dv">9</span> <span class="op">*</span><span class="st"> </span>(total_<span class="dv">10</span> <span class="op">-</span><span class="st"> </span>total_<span class="dv">00</span>) <span class="op">+</span><span class="st"> </span>total_<span class="dv">00</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb52-4"><a href="chp2.html#cb52-4"></a><span class="st">  </span><span class="kw">select</span>(state, percent_urban)</span>
<span id="cb52-5"><a href="chp2.html#cb52-5"></a></span>
<span id="cb52-6"><a href="chp2.html#cb52-6"></a>urban</span></code></pre></div>
<pre><code># A tibble: 51 x 2
   state                percent_urban
   &lt;chr&gt;                        &lt;dbl&gt;
 1 Alabama                       58.7
 2 Alaska                        66.0
 3 Arizona                       89.7
 4 Arkansas                      55.8
 5 California                    94.9
 6 Colorado                      86.0
 7 Connecticut                   88.0
 8 Delaware                      83.0
 9 District of Columbia         100  
10 Florida                       91.0
# ... with 41 more rows</code></pre>
<p>We now have 4 data frames containing the information we need to create Table 2.5 and Figure 2.3. We will create a one data frame by joining the four data frames using the dplyr package.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="chp2.html#cb54-1"></a>crime_df &lt;-<span class="st"> </span>crime_one_year_of_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb54-2"><a href="chp2.html#cb54-2"></a><span class="st">  </span><span class="kw">right_join</span>(single_parents) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb54-3"><a href="chp2.html#cb54-3"></a><span class="st">  </span><span class="kw">right_join</span>(urban) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb54-4"><a href="chp2.html#cb54-4"></a><span class="st">  </span><span class="kw">right_join</span>(acs_<span class="dv">09</span>_1yr_s1701_with_ann) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb54-5"><a href="chp2.html#cb54-5"></a><span class="st">  </span><span class="kw">select</span>(state, violent_crime_rate, percent_single_parents,</span>
<span id="cb54-6"><a href="chp2.html#cb54-6"></a>         percent_urban, percent_poverty)</span>
<span id="cb54-7"><a href="chp2.html#cb54-7"></a></span>
<span id="cb54-8"><a href="chp2.html#cb54-8"></a>crime_df</span></code></pre></div>
<pre><code># A tibble: 51 x 5
   state       violent_crime_r~ percent_single_pa~ percent_urban percent_poverty
   &lt;chr&gt;                  &lt;dbl&gt;              &lt;dbl&gt;         &lt;dbl&gt;           &lt;dbl&gt;
 1 Alabama                 450.              0.389          58.7            17.5
 2 Alaska                  633.              0.303          66.0             9  
 3 Arizona                 426.              0.365          89.7            16.5
 4 Arkansas                516.              0.378          55.8            18.8
 5 California              473.              0.324          94.9            14.2
 6 Colorado                339.              0.280          86.0            12.9
 7 Connecticut             301.              0.299          88.0             9.4
 8 Delaware                645.              0.376          83.0            10.8
 9 District o~            1349.              0.608         100              18.4
10 Florida                 612.              0.377          91.0            14.9
# ... with 41 more rows</code></pre>
<p>Figure 2.3 includes state abbreviations rather than state names. We will change the names into abbreviations with the help of a built in character vector. <code>state.name</code> is character vector of state names, excluding Washington DC, built into R. We can concatenate that vector with the character string “District of Columbia”, sort the new character vector alphabetically, convert the names to abbreviations with <code>state2abbr</code> from the <code>openintro</code> package, and assign the result to the state vector in the crime_one_year_of_data data frame.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="chp2.html#cb56-1"></a><span class="kw">library</span>(openintro)</span>
<span id="cb56-2"><a href="chp2.html#cb56-2"></a>state_abb &lt;-<span class="st"> </span><span class="kw">c</span>(state.name, <span class="st">&quot;District of Columbia&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb56-3"><a href="chp2.html#cb56-3"></a><span class="st">  </span><span class="kw">sort</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb56-4"><a href="chp2.html#cb56-4"></a><span class="st">  </span><span class="kw">state2abbr</span>()</span>
<span id="cb56-5"><a href="chp2.html#cb56-5"></a>crime_df<span class="op">$</span>state &lt;-<span class="st"> </span>state_abb  </span>
<span id="cb56-6"><a href="chp2.html#cb56-6"></a>crime_df <span class="op">%&gt;%</span><span class="st"> </span>glimpse</span></code></pre></div>
<pre><code>Rows: 51
Columns: 5
$ state                  &lt;chr&gt; &quot;AL&quot;, &quot;AK&quot;, &quot;AZ&quot;, &quot;AR&quot;, &quot;CA&quot;, &quot;CO&quot;, &quot;CT&quot;, &quot;D...
$ violent_crime_rate     &lt;dbl&gt; 450, 633, 426, 516, 473, 339, 301, 645, 1349...
$ percent_single_parents &lt;dbl&gt; 0.389, 0.303, 0.365, 0.378, 0.324, 0.280, 0....
$ percent_urban          &lt;dbl&gt; 58.7, 66.0, 89.7, 55.8, 94.9, 86.0, 88.0, 83...
$ percent_poverty        &lt;dbl&gt; 17.5, 9.0, 16.5, 18.8, 14.2, 12.9, 9.4, 10.8...</code></pre>
<p>We proceed as we did with Table 2.1 to reproduce Table 2.5. This time we will use the <code>gt</code> package.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="chp2.html#cb58-1"></a>crime_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-2"><a href="chp2.html#cb58-2"></a><span class="st">  </span><span class="kw">select</span>(<span class="st">&quot;Percent poverty&quot;</span> =<span class="st"> </span>percent_poverty,</span>
<span id="cb58-3"><a href="chp2.html#cb58-3"></a>         <span class="st">&quot;Percent single parents&quot;</span> =<span class="st"> </span>percent_single_parents,</span>
<span id="cb58-4"><a href="chp2.html#cb58-4"></a>         <span class="st">&quot;Percent urban&quot;</span> =<span class="st"> </span>percent_urban,</span>
<span id="cb58-5"><a href="chp2.html#cb58-5"></a>         <span class="st">&quot;Violent crime rate (per 100,00 people)&quot;</span> =<span class="st"> </span>violent_crime_rate) <span class="op">%&gt;%</span></span>
<span id="cb58-6"><a href="chp2.html#cb58-6"></a><span class="st">  </span>summarytools<span class="op">::</span><span class="kw">descr</span>(<span class="dt">stats =</span> <span class="kw">c</span>(<span class="st">&quot;n.valid&quot;</span>, <span class="st">&quot;mean&quot;</span>, <span class="st">&quot;sd&quot;</span>, <span class="st">&quot;min&quot;</span>, <span class="st">&quot;max&quot;</span>),</span>
<span id="cb58-7"><a href="chp2.html#cb58-7"></a>                      <span class="dt">round.digits =</span> <span class="dv">2</span>,</span>
<span id="cb58-8"><a href="chp2.html#cb58-8"></a>                      <span class="dt">transpose =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb58-9"><a href="chp2.html#cb58-9"></a><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-10"><a href="chp2.html#cb58-10"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Variable =</span> <span class="kw">c</span>(<span class="st">&quot;Percent poverty&quot;</span>,</span>
<span id="cb58-11"><a href="chp2.html#cb58-11"></a>         <span class="st">&quot;Percent single parents&quot;</span>,</span>
<span id="cb58-12"><a href="chp2.html#cb58-12"></a>         <span class="st">&quot;Percent urban&quot;</span>,</span>
<span id="cb58-13"><a href="chp2.html#cb58-13"></a>         <span class="st">&quot;Violent crime rate (per 100,00 people)&quot;</span>),</span>
<span id="cb58-14"><a href="chp2.html#cb58-14"></a>         <span class="dt">.before =</span> N.Valid) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-15"><a href="chp2.html#cb58-15"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">N =</span> N.Valid) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-16"><a href="chp2.html#cb58-16"></a><span class="st">  </span><span class="kw">arrange</span>(<span class="kw">desc</span>(Variable)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-17"><a href="chp2.html#cb58-17"></a><span class="st">  </span><span class="kw">gt</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-18"><a href="chp2.html#cb58-18"></a><span class="st">  </span><span class="kw">tab_header</span>(<span class="dt">title =</span> <span class="st">&quot;Table 2.5 Descriptive Statistics for State Crime Data&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb58-19"><a href="chp2.html#cb58-19"></a><span class="st">  </span><span class="kw">opt_align_table_header</span>(<span class="dt">align =</span> <span class="st">&quot;left&quot;</span>) </span></code></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#fxvdikkupd .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fxvdikkupd .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fxvdikkupd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fxvdikkupd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fxvdikkupd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fxvdikkupd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fxvdikkupd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fxvdikkupd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fxvdikkupd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fxvdikkupd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fxvdikkupd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fxvdikkupd .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#fxvdikkupd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fxvdikkupd .gt_from_md > :first-child {
  margin-top: 0;
}

#fxvdikkupd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fxvdikkupd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fxvdikkupd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#fxvdikkupd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fxvdikkupd .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#fxvdikkupd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fxvdikkupd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fxvdikkupd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fxvdikkupd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fxvdikkupd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fxvdikkupd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#fxvdikkupd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fxvdikkupd .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#fxvdikkupd .gt_left {
  text-align: left;
}

#fxvdikkupd .gt_center {
  text-align: center;
}

#fxvdikkupd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fxvdikkupd .gt_font_normal {
  font-weight: normal;
}

#fxvdikkupd .gt_font_bold {
  font-weight: bold;
}

#fxvdikkupd .gt_font_italic {
  font-style: italic;
}

#fxvdikkupd .gt_super {
  font-size: 65%;
}

#fxvdikkupd .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="fxvdikkupd" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="6" class="gt_heading gt_title gt_font_normal" style>Table 2.5 Descriptive Statistics for State Crime Data</th>
    </tr>
    <tr>
      <th colspan="6" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style></th>
    </tr>
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">Variable</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">N</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Std.Dev</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Min</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">Max</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr>
      <td class="gt_row gt_left">Violent crime rate (per 100,00 people)</td>
      <td class="gt_row gt_right">51</td>
      <td class="gt_row gt_right">406.535</td>
      <td class="gt_row gt_right">205.6164</td>
      <td class="gt_row gt_right">119.900</td>
      <td class="gt_row gt_right">1348.900</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Percent urban</td>
      <td class="gt_row gt_right">51</td>
      <td class="gt_row gt_right">73.932</td>
      <td class="gt_row gt_right">14.9185</td>
      <td class="gt_row gt_right">38.811</td>
      <td class="gt_row gt_right">100.000</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Percent single parents</td>
      <td class="gt_row gt_right">51</td>
      <td class="gt_row gt_right">0.332</td>
      <td class="gt_row gt_right">0.0642</td>
      <td class="gt_row gt_right">0.185</td>
      <td class="gt_row gt_right">0.608</td>
    </tr>
    <tr>
      <td class="gt_row gt_left">Percent poverty</td>
      <td class="gt_row gt_right">51</td>
      <td class="gt_row gt_right">13.855</td>
      <td class="gt_row gt_right">3.1106</td>
      <td class="gt_row gt_right">8.500</td>
      <td class="gt_row gt_right">21.900</td>
    </tr>
  </tbody>
  
  
</table></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="chp2.html#cb59-1"></a>  <span class="co"># DT::datatable(caption = htmltools::tags$caption(</span></span>
<span id="cb59-2"><a href="chp2.html#cb59-2"></a>  <span class="co">#               style = &quot;caption-side: top; text-align: left;&quot;,</span></span>
<span id="cb59-3"><a href="chp2.html#cb59-3"></a>  <span class="co">#               &quot;Table 2.5 Descriptive Statistics for State Crime Data&quot;),</span></span>
<span id="cb59-4"><a href="chp2.html#cb59-4"></a>  <span class="co">#               class = &quot;cell-border stripe&quot;,</span></span>
<span id="cb59-5"><a href="chp2.html#cb59-5"></a>  <span class="co">#               colnames = c(&quot;N&quot;, &quot;Mean&quot;, &quot;St. Dev.&quot;, &quot;Min&quot;, &quot;Max&quot;),</span></span>
<span id="cb59-6"><a href="chp2.html#cb59-6"></a>  <span class="co">#               options = list(dom = &quot;t&quot;))</span></span>
<span id="cb59-7"><a href="chp2.html#cb59-7"></a>  <span class="co"># as.data.frame() %&gt;% </span></span>
<span id="cb59-8"><a href="chp2.html#cb59-8"></a>  <span class="co"># stargazer(type = &quot;text&quot;, </span></span>
<span id="cb59-9"><a href="chp2.html#cb59-9"></a>  <span class="co">#           title = &quot;Table 2.3&quot;,</span></span>
<span id="cb59-10"><a href="chp2.html#cb59-10"></a>  <span class="co">#           omit.summary.stat = c(&quot;p25&quot;, &quot;p75&quot;)) </span></span></code></pre></div>
</div>
<div id="figure-2.3" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Figure 2.3</h3>
<p>We will use <code>ggplot</code> from the <code>ggplot2</code> package to reproduce Figure 2.3. We will use the <code>plot_grd</code> from <code>cowplot</code> package to create a grid of the three individual plots after we create them individually.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="chp2.html#cb60-1"></a>plot_urban &lt;-<span class="st"> </span></span>
<span id="cb60-2"><a href="chp2.html#cb60-2"></a><span class="st">  </span>crime_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb60-3"><a href="chp2.html#cb60-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> percent_urban, <span class="dt">y =</span> violent_crime_rate)) <span class="op">+</span></span>
<span id="cb60-4"><a href="chp2.html#cb60-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Percent urban</span><span class="ch">\n</span><span class="st">(0-to-100 scale)&quot;</span>, <span class="co"># \n creates a new line</span></span>
<span id="cb60-5"><a href="chp2.html#cb60-5"></a>       <span class="dt">y =</span> <span class="st">&quot;Violent</span><span class="ch">\n</span><span class="st">crime</span><span class="ch">\n</span><span class="st">rate</span><span class="ch">\n</span><span class="st">(per</span><span class="ch">\n</span><span class="st">100,000</span><span class="ch">\n</span><span class="st">people)&quot;</span>) <span class="op">+</span></span>
<span id="cb60-6"><a href="chp2.html#cb60-6"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> state), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb60-7"><a href="chp2.html#cb60-7"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">200</span>, <span class="dv">1200</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># creates a sequence from 200 to 1200 by 200</span></span>
<span id="cb60-8"><a href="chp2.html#cb60-8"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">40</span>, <span class="dv">100</span>, <span class="dv">10</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># creates a sequence from 40 to 100 by 10</span></span>
<span id="cb60-9"><a href="chp2.html#cb60-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>), </span>
<span id="cb60-10"><a href="chp2.html#cb60-10"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb60-11"><a href="chp2.html#cb60-11"></a>        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb60-12"><a href="chp2.html#cb60-12"></a>        <span class="dt">axis.line =</span> <span class="kw">element_line</span>())</span>
<span id="cb60-13"><a href="chp2.html#cb60-13"></a></span>
<span id="cb60-14"><a href="chp2.html#cb60-14"></a>plot_single &lt;-<span class="st"> </span></span>
<span id="cb60-15"><a href="chp2.html#cb60-15"></a><span class="st">  </span>crime_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb60-16"><a href="chp2.html#cb60-16"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> percent_single_parents, <span class="dt">y =</span> violent_crime_rate)) <span class="op">+</span></span>
<span id="cb60-17"><a href="chp2.html#cb60-17"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Percent single parent</span><span class="ch">\n</span><span class="st">(0-to-1 scale)&quot;</span>, <span class="co"># \n creates a new line</span></span>
<span id="cb60-18"><a href="chp2.html#cb60-18"></a>       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb60-19"><a href="chp2.html#cb60-19"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> state), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb60-20"><a href="chp2.html#cb60-20"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">200</span>, <span class="dv">1200</span>, <span class="dv">200</span>)) <span class="op">+</span></span>
<span id="cb60-21"><a href="chp2.html#cb60-21"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>), </span>
<span id="cb60-22"><a href="chp2.html#cb60-22"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb60-23"><a href="chp2.html#cb60-23"></a>        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb60-24"><a href="chp2.html#cb60-24"></a>        <span class="dt">axis.line =</span> <span class="kw">element_line</span>())</span>
<span id="cb60-25"><a href="chp2.html#cb60-25"></a></span>
<span id="cb60-26"><a href="chp2.html#cb60-26"></a>plot_poverty &lt;-<span class="st"> </span></span>
<span id="cb60-27"><a href="chp2.html#cb60-27"></a><span class="st">  </span>crime_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb60-28"><a href="chp2.html#cb60-28"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> percent_poverty, <span class="dt">y =</span> violent_crime_rate)) <span class="op">+</span></span>
<span id="cb60-29"><a href="chp2.html#cb60-29"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Percent poverty</span><span class="ch">\n</span><span class="st">(0-to-100 scale)&quot;</span>, <span class="co"># \n creates a new line</span></span>
<span id="cb60-30"><a href="chp2.html#cb60-30"></a>       <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb60-31"><a href="chp2.html#cb60-31"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> state), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb60-32"><a href="chp2.html#cb60-32"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">200</span>, <span class="dv">1200</span>, <span class="dv">200</span>)) <span class="op">+</span></span>
<span id="cb60-33"><a href="chp2.html#cb60-33"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">8</span>, <span class="dv">22</span>, <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb60-34"><a href="chp2.html#cb60-34"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>), </span>
<span id="cb60-35"><a href="chp2.html#cb60-35"></a>        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb60-36"><a href="chp2.html#cb60-36"></a>        <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb60-37"><a href="chp2.html#cb60-37"></a>        <span class="dt">axis.line =</span> <span class="kw">element_line</span>())</span>
<span id="cb60-38"><a href="chp2.html#cb60-38"></a></span>
<span id="cb60-39"><a href="chp2.html#cb60-39"></a><span class="kw">library</span>(cowplot)</span>
<span id="cb60-40"><a href="chp2.html#cb60-40"></a><span class="kw">plot_grid</span>(plot_urban, plot_single, plot_poverty,  <span class="dt">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="bailey_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>FIGURE 2.3: Scatterplots of Violent Crime against Percent Urban, Single Parent, and Poverty</p>
</div>
</div>
<div id="computing-center" class="section level2">
<h2><span class="header-section-number">4.3</span> Computing Center</h2>
<div id="reading-data" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Reading Data</h3>
<p>There are packages available to read data formatted in a variety of ways into R. A partial list is</p>
<table>
<thead>
<tr class="header">
<th>Package</th>
<th>Type of Data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>haven</code></td>
<td>SPSS, Stata, &amp; SAS</td>
</tr>
<tr class="even">
<td><code>httr</code></td>
<td>Web APIs</td>
</tr>
<tr class="odd">
<td><code>readxl</code></td>
<td>.xls &amp; .xlsx sheets</td>
</tr>
<tr class="even">
<td><code>rvest</code></td>
<td>web scraping</td>
</tr>
<tr class="odd">
<td><code>jsonlite</code></td>
<td>JSON</td>
</tr>
<tr class="even">
<td><code>DBI</code></td>
<td>relational databases</td>
</tr>
<tr class="odd">
<td><code>xml2</code></td>
<td>XML</td>
</tr>
</tbody>
</table>
<p>Data can also be imported using the Import Dataset icon in the Environment/History pane. When learning to import data, this method can be useful as it will create the command line necessary to import the data, which you can then paste into your source file.</p>
</div>
<div id="manually-entering-data" class="section level3">
<h3><span class="header-section-number">4.3.2</span> Manually Entering Data</h3>
<p>In Chapter 1 we saw that we can directly (manually) enter data into R as well. Below is the appropriate syntax for doing so. The function call <code>c()</code> <em>combines</em> or <em>concatenates</em> elements into a vector.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="chp2.html#cb61-1"></a>name &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Homer&quot;</span>, <span class="st">&quot;Marge&quot;</span>, <span class="st">&quot;Lisa&quot;</span>, <span class="st">&quot;Bart&quot;</span>, <span class="st">&quot;Comic Book Guy&quot;</span>, <span class="st">&quot;Mr. Burns&quot;</span>, <span class="st">&quot;Smithers&quot;</span>, <span class="st">&quot;Chief Wiggum&quot;</span>, <span class="st">&quot;Principle Skinner&quot;</span>, <span class="st">&quot;Rev. Lovejoy&quot;</span>, <span class="st">&quot;Ned Flanders&quot;</span>, <span class="st">&quot;Patty&quot;</span>, <span class="st">&quot;Selma&quot;</span>)</span>
<span id="cb61-2"><a href="chp2.html#cb61-2"></a>donuts_per_week &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">14</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">20</span>, <span class="fl">0.75</span>, <span class="fl">0.25</span>, <span class="dv">16</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="fl">0.8</span>, <span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb61-3"><a href="chp2.html#cb61-3"></a>weight &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">275</span>, <span class="dv">141</span>, <span class="dv">70</span>, <span class="dv">75</span>, <span class="dv">310</span>, <span class="dv">80</span>, <span class="dv">160</span>, <span class="dv">263</span>, <span class="dv">205</span>, <span class="dv">185</span>, <span class="dv">170</span>, <span class="dv">155</span>, <span class="dv">145</span>)</span></code></pre></div>
<p>We can combine this into a single “file” called a <em>data frame</em> as follows:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="chp2.html#cb62-1"></a>Donuts &lt;-<span class="st"> </span><span class="kw">data.frame</span>(name, donuts_per_week, weight)</span>
<span id="cb62-2"><a href="chp2.html#cb62-2"></a>Donuts <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb62-3"><a href="chp2.html#cb62-3"></a><span class="st">  </span><span class="kw">str</span>()</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:	13 obs. of  3 variables:
 $ name           : Factor w/ 13 levels &quot;Bart&quot;,&quot;Chief Wiggum&quot;,..: 4 6 5 1 3 7 13 2 10 11 ...
 $ donuts_per_week: num  14 0 0 5 20 0.75 0.25 16 3 2 ...
 $ weight         : num  275 141 70 75 310 80 160 263 205 185 ...</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="chp2.html#cb64-1"></a><span class="co"># could also use the modern version of data.frame</span></span>
<span id="cb64-2"><a href="chp2.html#cb64-2"></a><span class="kw">tibble</span>(name, donuts_per_week, weight) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb64-3"><a href="chp2.html#cb64-3"></a><span class="st">  </span><span class="kw">str</span>()</span></code></pre></div>
<pre><code>tibble [13 x 3] (S3: tbl_df/tbl/data.frame)
 $ name           : chr [1:13] &quot;Homer&quot; &quot;Marge&quot; &quot;Lisa&quot; &quot;Bart&quot; ...
 $ donuts_per_week: num [1:13] 14 0 0 5 20 0.75 0.25 16 3 2 ...
 $ weight         : num [1:13] 275 141 70 75 310 80 160 263 205 185 ...</code></pre>
<p>The character vector “name” is coerced to a Factor by default. Factors in R are store as a vector of integer values with a corresponding set of character values. We will see that Factors are very useful, however, in this case we want name to remain a character vector. If we add the option <code>stringsAsFactors = FALSE</code> to our call of <code>data.frame</code> we can prevent the coercion. Our we can call <code>tibble</code> as described in Chapter 1.</p>
<p>We can see the difference above.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="chp2.html#cb66-1"></a>Donuts &lt;-<span class="st"> </span><span class="kw">data.frame</span>(name, donuts_per_week, weight, <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb66-2"><a href="chp2.html#cb66-2"></a>Donuts <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str</span>()</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:	13 obs. of  3 variables:
 $ name           : chr  &quot;Homer&quot; &quot;Marge&quot; &quot;Lisa&quot; &quot;Bart&quot; ...
 $ donuts_per_week: num  14 0 0 5 20 0.75 0.25 16 3 2 ...
 $ weight         : num  275 141 70 75 310 80 160 263 205 185 ...</code></pre>
<p>You can see in the Global Environment tab of the Environment/History pane that you have an object named Donuts that has 13 observations on 3 variables. In addition, you can see under values you have each variable as well.</p>
</div>
<div id="simple-statistics" class="section level3">
<h3><span class="header-section-number">4.3.3</span> Simple Statistics</h3>
<p>R has many built in calls to get basic statistics on data. For example, to get the mean of a variable call <code>mean()</code>. Be aware, that if there are missing values in the data the function call will return <code>NA</code> as it’s result. <code>NA</code> is contagious, <em>i.e.</em>, if any of the observations are <code>NA</code> function calls will generally return <code>NA</code>. The upshot of this is it forces you into having a strategy to deal with <code>NAs</code>. The donuts data frame contains to missing values “NA”, so it won’t be a problem. Some simple exploratory data analysis will let you know if you have any issues in the data. We saw one of those problems above when we had a variable that we thought was numeric, but was read in as a character vector. <code>summary</code> is a good place to start.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="chp2.html#cb68-1"></a>donuts <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb68-2"><a href="chp2.html#cb68-2"></a><span class="st">  </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code> observation_number     name           donuts_per_week     weight   
 Min.   : 1         Length:13          Min.   : 0.00   Min.   : 70  
 1st Qu.: 4         Class :character   1st Qu.: 0.75   1st Qu.:141  
 Median : 7         Mode  :character   Median : 3.00   Median :160  
 Mean   : 7                            Mean   : 5.45   Mean   :172  
 3rd Qu.:10                            3rd Qu.: 5.00   3rd Qu.:205  
 Max.   :13                            Max.   :20.00   Max.   :310  
      male      
 Min.   :0.000  
 1st Qu.:0.000  
 Median :1.000  
 Mean   :0.692  
 3rd Qu.:1.000  
 Max.   :1.000  </code></pre>
<p>The <code>summarytools</code> package has a variety of tools to expand on the capabilities of <code>summary</code>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="chp2.html#cb70-1"></a>summarytools<span class="op">::</span><span class="kw">descr</span>(donuts)</span></code></pre></div>
<pre><code>Descriptive Statistics  

                    donuts_per_week     male   observation_number   weight
----------------- ----------------- -------- -------------------- --------
             Mean              5.45     0.69                 7.00   171.85
          Std.Dev              6.75     0.48                 3.89    76.16
              Min              0.00     0.00                 1.00    70.00
               Q1              0.75     0.00                 4.00   141.00
           Median              3.00     1.00                 7.00   160.00
               Q3              5.00     1.00                10.00   205.00
              Max             20.00     1.00                13.00   310.00
              MAD              3.34     0.00                 4.45    66.72
              IQR              4.25     1.00                 6.00    64.00
               CV              1.24     0.69                 0.56     0.44
         Skewness              1.04    -0.74                 0.00     0.30
      SE.Skewness              0.62     0.62                 0.62     0.62
         Kurtosis             -0.54    -1.56                -1.48    -1.13
          N.Valid             13.00    13.00                13.00    13.00
        Pct.Valid            100.00   100.00               100.00   100.00</code></pre>
<p>Note that <code>descr</code> ignores any character vectors.</p>
<p>We can get a table formatted for R Markdown with the argument <code>style = "rmarkdown"</code></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="chp2.html#cb72-1"></a>donuts <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb72-2"><a href="chp2.html#cb72-2"></a><span class="st">  </span>summarytools<span class="op">::</span><span class="kw">descr</span>(<span class="dt">style =</span> <span class="st">&quot;rmarkdown&quot;</span>)</span></code></pre></div>
<pre><code>### Descriptive Statistics  
#### donuts  
**N:** 13  

|          &amp;nbsp; | donuts_per_week |   male | observation_number | weight |
|----------------:|----------------:|-------:|-------------------:|-------:|
|        **Mean** |            5.45 |   0.69 |               7.00 | 171.85 |
|     **Std.Dev** |            6.75 |   0.48 |               3.89 |  76.16 |
|         **Min** |            0.00 |   0.00 |               1.00 |  70.00 |
|          **Q1** |            0.75 |   0.00 |               4.00 | 141.00 |
|      **Median** |            3.00 |   1.00 |               7.00 | 160.00 |
|          **Q3** |            5.00 |   1.00 |              10.00 | 205.00 |
|         **Max** |           20.00 |   1.00 |              13.00 | 310.00 |
|         **MAD** |            3.34 |   0.00 |               4.45 |  66.72 |
|         **IQR** |            4.25 |   1.00 |               6.00 |  64.00 |
|          **CV** |            1.24 |   0.69 |               0.56 |   0.44 |
|    **Skewness** |            1.04 |  -0.74 |               0.00 |   0.30 |
| **SE.Skewness** |            0.62 |   0.62 |               0.62 |   0.62 |
|    **Kurtosis** |           -0.54 |  -1.56 |              -1.48 |  -1.13 |
|     **N.Valid** |           13.00 |  13.00 |              13.00 |  13.00 |
|   **Pct.Valid** |          100.00 | 100.00 |             100.00 | 100.00 |</code></pre>
<p>We confirmed that there are no missing values in our data. If there were, we can easily deal with them with the argument <code>na.rm = TRUE</code>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="chp2.html#cb74-1"></a>donuts<span class="op">$</span>weight <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb74-2"><a href="chp2.html#cb74-2"></a><span class="st">  </span><span class="kw">mean</span>(<span class="dt">na.rm =</span> <span class="ot">TRUE</span>)  </span></code></pre></div>
<pre><code>[1] 172</code></pre>
<p>Call <code>var</code> or <code>sd</code> to return the sample variance or sample standard deviation. Of course the standard deviation can also be calculated by calling <code>sqrt</code> on the result of the <code>var</code> call. There are multiple ways to retrieve the number of observations of a variable or data frame. The minimum and maximum values are returned by calling <code>min</code> and <code>max</code>. As described in the text, we can call <code>sum</code> on the result of the call <code>is.finite</code>. <code>nrow</code> will return the number of observations in a data frame, <code>NROW</code> will return the number of observations of a vector or single variable.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="chp2.html#cb76-1"></a>donuts<span class="op">$</span>weight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">var</span>()</span></code></pre></div>
<pre><code>[1] 5800</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="chp2.html#cb78-1"></a>donuts<span class="op">$</span>weight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">var</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sqrt</span>()</span></code></pre></div>
<pre><code>[1] 76.2</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="chp2.html#cb80-1"></a>donuts<span class="op">$</span>weight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sd</span>()</span></code></pre></div>
<pre><code>[1] 76.2</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="chp2.html#cb82-1"></a>donuts<span class="op">$</span>weight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">min</span>()</span></code></pre></div>
<pre><code>[1] 70</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="chp2.html#cb84-1"></a>donuts<span class="op">$</span>weight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">max</span>()</span></code></pre></div>
<pre><code>[1] 310</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="chp2.html#cb86-1"></a>donuts<span class="op">$</span>weight <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">NROW</span>()</span></code></pre></div>
<pre><code>[1] 13</code></pre>
</div>
<div id="subsetting" class="section level3">
<h3><span class="header-section-number">4.3.4</span> Subsetting</h3>
<p>Subsetting in R can be accomplished in a variety of ways. In Base R, use <code>[]</code> syntax. Use brackets can be used to call specific rows and columns from a matrix or data frame. To return the observation in the 12<sup>th</sup> row and 3<sup>rd</sup> column call <code>donuts[12,3]</code>. To return all of the observations in a specific row or column, leave the row or column number out of the call. To return all of the observations from the 3rd column call <code>donuts[,3]</code>. To return the observations for an individual record, say the 4<sup>th</sup> row, call <code>donuts[4,]</code>. To choose (subset) all of those records where, e.g,, donuts eaten per week is 0, call <code>donuts[donuts$donuts_per_week == 0,]</code>; to choose all those records where donuts donuts are not equal to 0, call <code>donuts[donuts$donuts_per_week != 0,]</code>. We can also subset using <code>filter</code> from <code>dplyr</code>. An advantage of subsetting with <code>dplyr</code> is that the resulting tibble can be piped into the another function call.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="chp2.html#cb88-1"></a>donuts[<span class="dv">12</span>,<span class="dv">3</span>]</span></code></pre></div>
<pre><code># A tibble: 1 x 1
  donuts_per_week
            &lt;dbl&gt;
1               5</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="chp2.html#cb90-1"></a>donuts[,<span class="dv">3</span>]</span></code></pre></div>
<pre><code># A tibble: 13 x 1
   donuts_per_week
             &lt;dbl&gt;
 1           14   
 2            0   
 3            0   
 4            5   
 5           20   
 6            0.75
 7            0.25
 8           16   
 9            3   
10            2   
11            0.8 
12            5   
13            4   </code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="chp2.html#cb92-1"></a>donuts[<span class="dv">4</span>,]</span></code></pre></div>
<pre><code># A tibble: 1 x 5
  observation_number name  donuts_per_week weight  male
               &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1                  4 Bart                5     75     1</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="chp2.html#cb94-1"></a>donuts[donuts<span class="op">$</span>donuts_per_week <span class="op">==</span><span class="st"> </span><span class="dv">0</span>,]</span></code></pre></div>
<pre><code># A tibble: 2 x 5
  observation_number name  donuts_per_week weight  male
               &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1                  2 Marge               0    141     0
2                  3 Lisa                0     70     0</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="chp2.html#cb96-1"></a>donuts[donuts<span class="op">$</span>donuts_per_week <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>,]</span></code></pre></div>
<pre><code># A tibble: 11 x 5
   observation_number name              donuts_per_week weight  male
                &lt;int&gt; &lt;chr&gt;                       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1                  1 Homer                       14       275     1
 2                  4 Bart                         5        75     1
 3                  5 Comic Book Guy              20       310     1
 4                  6 Mr. Burns                    0.75     80     1
 5                  7 Smithers                     0.25    160     1
 6                  8 Chief Wiggum                16       263     1
 7                  9 Principle Skinner            3       205     1
 8                 10 Rev. Lovejoy                 2       185     1
 9                 11 Ned Flanders                 0.8     170     1
10                 12 Patty                        5       155     0
11                 13 Selma                        4       145     0</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="chp2.html#cb98-1"></a>donuts <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb98-2"><a href="chp2.html#cb98-2"></a><span class="st">  </span><span class="kw">filter</span>(donuts_per_week <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code># A tibble: 2 x 5
  observation_number name  donuts_per_week weight  male
               &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1                  2 Marge               0    141     0
2                  3 Lisa                0     70     0</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="chp2.html#cb100-1"></a>donuts <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb100-2"><a href="chp2.html#cb100-2"></a><span class="st">  </span><span class="kw">filter</span>(donuts_per_week <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<pre><code># A tibble: 11 x 5
   observation_number name              donuts_per_week weight  male
                &lt;int&gt; &lt;chr&gt;                       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1                  1 Homer                       14       275     1
 2                  4 Bart                         5        75     1
 3                  5 Comic Book Guy              20       310     1
 4                  6 Mr. Burns                    0.75     80     1
 5                  7 Smithers                     0.25    160     1
 6                  8 Chief Wiggum                16       263     1
 7                  9 Principle Skinner            3       205     1
 8                 10 Rev. Lovejoy                 2       185     1
 9                 11 Ned Flanders                 0.8     170     1
10                 12 Patty                        5       155     0
11                 13 Selma                        4       145     0</code></pre>
<p>We can subset on more than one variable as well. Using Base R we can choose all those males who consumed some donuts per week by calling <code>donuts[donuts$donuts_per_week != 0 &amp; donuts$male == 1]</code>. We can choose all those observations where donut consumption per week is more than 15 or the person is female by using the or operator | in call <code>donuts[donuts$donuts_per_week &gt; 15 | donuts$male != 1,]</code>. <code>filter</code> can be used as well.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="chp2.html#cb102-1"></a>donuts[donuts<span class="op">$</span>donuts_per_week <span class="op">!=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>donuts<span class="op">$</span>male <span class="op">==</span><span class="st"> </span><span class="dv">1</span>,]</span></code></pre></div>
<pre><code># A tibble: 9 x 5
  observation_number name              donuts_per_week weight  male
               &lt;int&gt; &lt;chr&gt;                       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1                  1 Homer                       14       275     1
2                  4 Bart                         5        75     1
3                  5 Comic Book Guy              20       310     1
4                  6 Mr. Burns                    0.75     80     1
5                  7 Smithers                     0.25    160     1
6                  8 Chief Wiggum                16       263     1
7                  9 Principle Skinner            3       205     1
8                 10 Rev. Lovejoy                 2       185     1
9                 11 Ned Flanders                 0.8     170     1</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="chp2.html#cb104-1"></a>donuts <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb104-2"><a href="chp2.html#cb104-2"></a><span class="st">  </span><span class="kw">filter</span>(donuts_per_week <span class="op">!=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>male <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<pre><code># A tibble: 9 x 5
  observation_number name              donuts_per_week weight  male
               &lt;int&gt; &lt;chr&gt;                       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1                  1 Homer                       14       275     1
2                  4 Bart                         5        75     1
3                  5 Comic Book Guy              20       310     1
4                  6 Mr. Burns                    0.75     80     1
5                  7 Smithers                     0.25    160     1
6                  8 Chief Wiggum                16       263     1
7                  9 Principle Skinner            3       205     1
8                 10 Rev. Lovejoy                 2       185     1
9                 11 Ned Flanders                 0.8     170     1</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="chp2.html#cb106-1"></a><span class="co"># a slightly more intuitive alternative is:</span></span>
<span id="cb106-2"><a href="chp2.html#cb106-2"></a>donuts <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb106-3"><a href="chp2.html#cb106-3"></a><span class="st">  </span><span class="kw">filter</span>(donuts_per_week <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>, male <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) </span></code></pre></div>
<pre><code># A tibble: 9 x 5
  observation_number name              donuts_per_week weight  male
               &lt;int&gt; &lt;chr&gt;                       &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1                  1 Homer                       14       275     1
2                  4 Bart                         5        75     1
3                  5 Comic Book Guy              20       310     1
4                  6 Mr. Burns                    0.75     80     1
5                  7 Smithers                     0.25    160     1
6                  8 Chief Wiggum                16       263     1
7                  9 Principle Skinner            3       205     1
8                 10 Rev. Lovejoy                 2       185     1
9                 11 Ned Flanders                 0.8     170     1</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="chp2.html#cb108-1"></a>donuts[donuts<span class="op">$</span>donuts_per_week <span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span> <span class="op">|</span><span class="st"> </span>donuts<span class="op">$</span>male <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>,]</span></code></pre></div>
<pre><code># A tibble: 6 x 5
  observation_number name           donuts_per_week weight  male
               &lt;int&gt; &lt;chr&gt;                    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1                  2 Marge                        0    141     0
2                  3 Lisa                         0     70     0
3                  5 Comic Book Guy              20    310     1
4                  8 Chief Wiggum                16    263     1
5                 12 Patty                        5    155     0
6                 13 Selma                        4    145     0</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="chp2.html#cb110-1"></a>donuts <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb110-2"><a href="chp2.html#cb110-2"></a><span class="st">  </span><span class="kw">filter</span>(donuts_per_week <span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span> <span class="op">|</span><span class="st"> </span>male <span class="op">!=</span><span class="st"> </span><span class="dv">1</span>)</span></code></pre></div>
<pre><code># A tibble: 6 x 5
  observation_number name           donuts_per_week weight  male
               &lt;int&gt; &lt;chr&gt;                    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1                  2 Marge                        0    141     0
2                  3 Lisa                         0     70     0
3                  5 Comic Book Guy              20    310     1
4                  8 Chief Wiggum                16    263     1
5                 12 Patty                        5    155     0
6                 13 Selma                        4    145     0</code></pre>
<p>We can modify Figure 2.2 to include only males by modifying our original code by piping the filtered results into <code>ggplot</code>.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="chp2.html#cb112-1"></a><span class="kw">library</span>(ggrepel)</span>
<span id="cb112-2"><a href="chp2.html#cb112-2"></a>donuts <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb112-3"><a href="chp2.html#cb112-3"></a><span class="st">  </span><span class="kw">filter</span>(male <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb112-4"><a href="chp2.html#cb112-4"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> donuts_per_week, <span class="dt">y =</span> weight)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb112-5"><a href="chp2.html#cb112-5"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;gray80&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb112-6"><a href="chp2.html#cb112-6"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb112-7"><a href="chp2.html#cb112-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Donuts&quot;</span>, </span>
<span id="cb112-8"><a href="chp2.html#cb112-8"></a>       <span class="dt">y =</span> <span class="st">&quot;Weight</span><span class="ch">\n</span><span class="st">(in pounds)&quot;</span>, <span class="co"># \n creates a new line</span></span>
<span id="cb112-9"><a href="chp2.html#cb112-9"></a>       <span class="dt">caption =</span> <span class="st">&quot;Figure 2.2: Weight and Donuts in Springfield&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb112-10"><a href="chp2.html#cb112-10"></a><span class="st">  </span><span class="kw">geom_text_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> name), <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span></span>
<span id="cb112-11"><a href="chp2.html#cb112-11"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>), </span>
<span id="cb112-12"><a href="chp2.html#cb112-12"></a>          <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb112-13"><a href="chp2.html#cb112-13"></a>          <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb112-14"><a href="chp2.html#cb112-14"></a>          <span class="dt">axis.line =</span> <span class="kw">element_line</span>(), </span>
<span id="cb112-15"><a href="chp2.html#cb112-15"></a>          <span class="dt">plot.caption =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>)) </span></code></pre></div>
<p><img src="bailey_files/figure-html/figure2.2mod-1.png" width="672" /></p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="5">
<li id="fn5"><p>These types of files are often referred to as <em>flat files</em>.<a href="chp2.html#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p><code>readr</code> is part of the Tidyverse.<a href="chp2.html#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>All of the text’s data files are available in <code>csv</code> format, so we will make repeated use of <code>read_csv</code>.<a href="chp2.html#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>We could also open the file with either Excel or text editor.<a href="chp2.html#fnref8" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chp1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cph3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bailey.pdf", "bailey.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
