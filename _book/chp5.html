<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Multivariate OLS: Where the Action Is | R Companion to Real Econometrics</title>
  <meta name="description" content="R, RStudio IDE, and the tidyverse companion to Bailey’s Real Econometrics" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Multivariate OLS: Where the Action Is | R Companion to Real Econometrics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="R, RStudio IDE, and the tidyverse companion to Bailey’s Real Econometrics" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Multivariate OLS: Where the Action Is | R Companion to Real Econometrics" />
  
  <meta name="twitter:description" content="R, RStudio IDE, and the tidyverse companion to Bailey’s Real Econometrics" />
  

<meta name="author" content="Tony Carilli" />


<meta name="date" content="2020-08-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chp4.html"/>
<link rel="next" href="chp6.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Companion to *Real Econometrics*</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#install-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> Install R and RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#using-rstudio"><i class="fa fa-check"></i><b>2.2</b> Using RStudio</a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#source-pane"><i class="fa fa-check"></i><b>2.2.1</b> Source Pane</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#environmenthistory-pane"><i class="fa fa-check"></i><b>2.2.2</b> Environment/History Pane</a></li>
<li class="chapter" data-level="2.2.3" data-path="intro.html"><a href="intro.html#console-pane"><i class="fa fa-check"></i><b>2.2.3</b> Console Pane</a></li>
<li class="chapter" data-level="2.2.4" data-path="intro.html"><a href="intro.html#filesplotspackageshelp-pane"><i class="fa fa-check"></i><b>2.2.4</b> Files/Plots/Packages/Help Pane</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#r-markdown"><i class="fa fa-check"></i><b>2.3</b> R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chp1.html"><a href="chp1.html"><i class="fa fa-check"></i><b>3</b> The Quest for Causality</a><ul>
<li class="chapter" data-level="3.1" data-path="chp1.html"><a href="chp1.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="chp1.html"><a href="chp1.html#table-1.1"><i class="fa fa-check"></i><b>3.1.1</b> Table 1.1</a></li>
<li class="chapter" data-level="3.1.2" data-path="chp1.html"><a href="chp1.html#figure-1.2"><i class="fa fa-check"></i><b>3.1.2</b> Figure 1.2</a></li>
<li class="chapter" data-level="3.1.3" data-path="chp1.html"><a href="chp1.html#figure-1.3"><i class="fa fa-check"></i><b>3.1.3</b> Figure 1.3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chp2.html"><a href="chp2.html"><i class="fa fa-check"></i><b>4</b> Stats in the Wild: Good Data Practices</a><ul>
<li class="chapter" data-level="4.1" data-path="chp1.html"><a href="chp1.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="chp2.html"><a href="chp2.html#table-and-figure-reproduction"><i class="fa fa-check"></i><b>4.2</b> Table and Figure Reproduction</a><ul>
<li class="chapter" data-level="4.2.1" data-path="chp2.html"><a href="chp2.html#table-2.1"><i class="fa fa-check"></i><b>4.2.1</b> Table 2.1</a></li>
<li class="chapter" data-level="4.2.2" data-path="chp2.html"><a href="chp2.html#table-2.2"><i class="fa fa-check"></i><b>4.2.2</b> Table 2.2</a></li>
<li class="chapter" data-level="4.2.3" data-path="chp2.html"><a href="chp2.html#table-2.5"><i class="fa fa-check"></i><b>4.2.3</b> Table 2.5</a></li>
<li class="chapter" data-level="4.2.4" data-path="chp2.html"><a href="chp2.html#figure-2.3"><i class="fa fa-check"></i><b>4.2.4</b> Figure 2.3</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chp2.html"><a href="chp2.html#computing-center"><i class="fa fa-check"></i><b>4.3</b> Computing Center</a><ul>
<li class="chapter" data-level="4.3.1" data-path="chp2.html"><a href="chp2.html#reading-data"><i class="fa fa-check"></i><b>4.3.1</b> Reading Data</a></li>
<li class="chapter" data-level="4.3.2" data-path="chp2.html"><a href="chp2.html#manually-entering-data"><i class="fa fa-check"></i><b>4.3.2</b> Manually Entering Data</a></li>
<li class="chapter" data-level="4.3.3" data-path="chp2.html"><a href="chp2.html#simple-statistics"><i class="fa fa-check"></i><b>4.3.3</b> Simple Statistics</a></li>
<li class="chapter" data-level="4.3.4" data-path="chp2.html"><a href="chp2.html#subsetting"><i class="fa fa-check"></i><b>4.3.4</b> Subsetting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cph3.html"><a href="cph3.html"><i class="fa fa-check"></i><b>5</b> Bivariate OLS: The Foundation of Econometric Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="cph3.html"><a href="cph3.html#estimating-a-simple-regression"><i class="fa fa-check"></i><b>5.1</b> Estimating a simple regression</a><ul>
<li class="chapter" data-level="5.1.1" data-path="cph3.html"><a href="cph3.html#a-short-detour-on-some-r-basics."><i class="fa fa-check"></i><b>5.1.1</b> A short detour on some R basics.</a></li>
<li class="chapter" data-level="5.1.2" data-path="cph3.html"><a href="cph3.html#estimating-an-ols-model"><i class="fa fa-check"></i><b>5.1.2</b> Estimating an OLS model</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="cph3.html"><a href="cph3.html#scatter-plot-with-regression-line"><i class="fa fa-check"></i><b>5.2</b> Scatter Plot with Regression Line</a></li>
<li class="chapter" data-level="5.3" data-path="cph3.html"><a href="cph3.html#subsetting-data-for-regressions"><i class="fa fa-check"></i><b>5.3</b> Subsetting Data for Regressions</a><ul>
<li class="chapter" data-level="5.3.1" data-path="cph3.html"><a href="cph3.html#the-operator"><i class="fa fa-check"></i><b>5.3.1</b> The <code>[</code> operator</a></li>
<li class="chapter" data-level="5.3.2" data-path="cph3.html"><a href="cph3.html#subset-argument"><i class="fa fa-check"></i><b>5.3.2</b> Subset argument</a></li>
<li class="chapter" data-level="5.3.3" data-path="cph3.html"><a href="cph3.html#dplyrfilter"><i class="fa fa-check"></i><b>5.3.3</b> <code>dplyr::filter</code></a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="cph3.html"><a href="cph3.html#heteroscesdasticity-consistent-standard-errors."><i class="fa fa-check"></i><b>5.4</b> Heteroscesdasticity-consistent standard errors.</a><ul>
<li class="chapter" data-level="5.4.1" data-path="cph3.html"><a href="cph3.html#estimatr-package"><i class="fa fa-check"></i><b>5.4.1</b> <code>estimatr</code> package</a></li>
<li class="chapter" data-level="5.4.2" data-path="cph3.html"><a href="cph3.html#jtools-package-1"><i class="fa fa-check"></i><b>5.4.2</b> <code>jtools</code> package</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="cph3.html"><a href="cph3.html#generating-random-numbers"><i class="fa fa-check"></i><b>5.5</b> Generating Random Numbers</a></li>
<li class="chapter" data-level="5.6" data-path="cph3.html"><a href="cph3.html#simulations"><i class="fa fa-check"></i><b>5.6</b> Simulations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chp4.html"><a href="chp4.html"><i class="fa fa-check"></i><b>6</b> Hypothesis Testing and Interval Estimation; Answering Research Questions</a><ul>
<li class="chapter" data-level="6.1" data-path="chp4.html"><a href="chp4.html#computing-corner"><i class="fa fa-check"></i><b>6.1</b> Computing Corner</a><ul>
<li class="chapter" data-level="6.1.1" data-path="chp4.html"><a href="chp4.html#probability-distributions-in-r"><i class="fa fa-check"></i><b>6.1.1</b> Probability Distributions in R</a></li>
<li class="chapter" data-level="6.1.2" data-path="chp4.html"><a href="chp4.html#critical-values-in-r"><i class="fa fa-check"></i><b>6.1.2</b> Critical Values in R</a></li>
<li class="chapter" data-level="6.1.3" data-path="chp4.html"><a href="chp4.html#confidence-intervals-for-ols-estimates"><i class="fa fa-check"></i><b>6.1.3</b> Confidence Intervals for OLS estimates</a></li>
<li class="chapter" data-level="6.1.4" data-path="chp4.html"><a href="chp4.html#power-curves"><i class="fa fa-check"></i><b>6.1.4</b> Power Curves</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chp5.html"><a href="chp5.html"><i class="fa fa-check"></i><b>7</b> Multivariate OLS: Where the Action Is</a><ul>
<li class="chapter" data-level="7.1" data-path="chp4.html"><a href="chp4.html#computing-corner"><i class="fa fa-check"></i><b>7.1</b> Computing Corner</a><ul>
<li class="chapter" data-level="7.1.1" data-path="chp5.html"><a href="chp5.html#multiple-regression"><i class="fa fa-check"></i><b>7.1.1</b> Multiple Regression</a></li>
<li class="chapter" data-level="7.1.2" data-path="chp5.html"><a href="chp5.html#multicollinearity"><i class="fa fa-check"></i><b>7.1.2</b> Multicollinearity</a></li>
<li class="chapter" data-level="7.1.3" data-path="chp5.html"><a href="chp5.html#standardized-coefficients"><i class="fa fa-check"></i><b>7.1.3</b> Standardized Coefficients</a></li>
<li class="chapter" data-level="7.1.4" data-path="chp5.html"><a href="chp5.html#f-tests"><i class="fa fa-check"></i><b>7.1.4</b> <em>F</em> tests</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chp6.html"><a href="chp6.html"><i class="fa fa-check"></i><b>8</b> Dummy Variables: Smarter than You Think</a><ul>
<li class="chapter" data-level="8.1" data-path="chp6.html"><a href="chp6.html#dummy-variables-in-r"><i class="fa fa-check"></i><b>8.1</b> Dummy Variables in R</a><ul>
<li class="chapter" data-level="8.1.1" data-path="chp6.html"><a href="chp6.html#factors"><i class="fa fa-check"></i><b>8.1.1</b> Factors</a></li>
<li class="chapter" data-level="8.1.2" data-path="chp6.html"><a href="chp6.html#character-vectors-as-dummies"><i class="fa fa-check"></i><b>8.1.2</b> Character Vectors as Dummies</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="chp6.html"><a href="chp6.html#difference-in-means-test"><i class="fa fa-check"></i><b>8.2</b> Difference in Means Test</a><ul>
<li class="chapter" data-level="8.2.1" data-path="chp6.html"><a href="chp6.html#using-t.test"><i class="fa fa-check"></i><b>8.2.1</b> Using <code>t.test</code></a></li>
<li class="chapter" data-level="8.2.2" data-path="chp6.html"><a href="chp6.html#using-lm-and-lm_robust"><i class="fa fa-check"></i><b>8.2.2</b> Using <code>lm</code> and <code>lm_robust</code></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="chp6.html"><a href="chp6.html#integer-and-numerical-vectors-as-dummy-variables"><i class="fa fa-check"></i><b>8.3</b> Integer and Numerical Vectors as Dummy Variables</a></li>
<li class="chapter" data-level="8.4" data-path="chp6.html"><a href="chp6.html#manipulating-factors"><i class="fa fa-check"></i><b>8.4</b> Manipulating Factors</a></li>
<li class="chapter" data-level="8.5" data-path="chp6.html"><a href="chp6.html#dummy-interaction-variables"><i class="fa fa-check"></i><b>8.5</b> Dummy Interaction Variables</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chp7.html"><a href="chp7.html"><i class="fa fa-check"></i><b>9</b> Specifying Models</a><ul>
<li class="chapter" data-level="9.1" data-path="chp7.html"><a href="chp7.html#polynomial-models"><i class="fa fa-check"></i><b>9.1</b> Polynomial Models</a></li>
<li class="chapter" data-level="9.2" data-path="chp7.html"><a href="chp7.html#logarithmic"><i class="fa fa-check"></i><b>9.2</b> Logarithmic</a><ul>
<li class="chapter" data-level="9.2.1" data-path="chp7.html"><a href="chp7.html#constant-elasticity-log-log-or-double-log"><i class="fa fa-check"></i><b>9.2.1</b> Constant Elasticity (log-log or double log)</a></li>
<li class="chapter" data-level="9.2.2" data-path="chp7.html"><a href="chp7.html#constant-growth-in-a-dependent-variable-log-lin-or-semilog"><i class="fa fa-check"></i><b>9.2.2</b> Constant Growth in a Dependent Variable (log-lin or semilog)</a></li>
<li class="chapter" data-level="9.2.3" data-path="chp7.html"><a href="chp7.html#constant-change-in-dependent-variable-lin-log"><i class="fa fa-check"></i><b>9.2.3</b> Constant % Change in Dependent Variable (lin-log)</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chp7.html"><a href="chp7.html#other-useful-functional-forms"><i class="fa fa-check"></i><b>9.3</b> Other Useful Functional Forms</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chp8.html"><a href="chp8.html"><i class="fa fa-check"></i><b>10</b> Using Fixed Effects Models to Fight Endogeneity in Panel Data and Difference–in–Difference Models</a><ul>
<li class="chapter" data-level="10.1" data-path="chp8.html"><a href="chp8.html#simpsons-paradox"><i class="fa fa-check"></i><b>10.1</b> Simpson’s Paradox</a></li>
<li class="chapter" data-level="10.2" data-path="chp8.html"><a href="chp8.html#figures-8.1-8.3"><i class="fa fa-check"></i><b>10.2</b> Figures 8.1-8.3</a></li>
<li class="chapter" data-level="10.3" data-path="chp8.html"><a href="chp8.html#one-way-fixed-effects-models"><i class="fa fa-check"></i><b>10.3</b> One-Way Fixed Effects Models</a><ul>
<li class="chapter" data-level="10.3.1" data-path="chp8.html"><a href="chp8.html#lsdv-approach"><i class="fa fa-check"></i><b>10.3.1</b> LSDV Approach</a></li>
<li class="chapter" data-level="10.3.2" data-path="chp8.html"><a href="chp8.html#f-test-for-significance-of-fixed-effects."><i class="fa fa-check"></i><b>10.3.2</b> <em>F</em>-test for significance of fixed effects.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="chp8.html"><a href="chp8.html#de-meaned-approach"><i class="fa fa-check"></i><b>10.4</b> De-Meaned approach</a><ul>
<li class="chapter" data-level="10.4.1" data-path="chp8.html"><a href="chp8.html#manually-de-mean"><i class="fa fa-check"></i><b>10.4.1</b> Manually De-Mean</a></li>
<li class="chapter" data-level="10.4.2" data-path="chp8.html"><a href="chp8.html#using-the-plm-package"><i class="fa fa-check"></i><b>10.4.2</b> Using the <code>plm</code> package</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="chp8.html"><a href="chp8.html#two-way-fixed-effects-models"><i class="fa fa-check"></i><b>10.5</b> Two-Way Fixed Effects Models</a><ul>
<li class="chapter" data-level="10.5.1" data-path="chp8.html"><a href="chp8.html#time-as-a-factor"><i class="fa fa-check"></i><b>10.5.1</b> Time as a factor</a></li>
<li class="chapter" data-level="10.5.2" data-path="chp8.html"><a href="chp8.html#effect-twoways"><i class="fa fa-check"></i><b>10.5.2</b> effect = “twoways”</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="chp8.html"><a href="chp8.html#difference-in-difference-models"><i class="fa fa-check"></i><b>10.6</b> Difference-in-Difference Models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chp9.html"><a href="chp9.html"><i class="fa fa-check"></i><b>11</b> Instrumental Variables: Using Exogenous Variation to Fight Endogeneity</a><ul>
<li class="chapter" data-level="11.1" data-path="chp9.html"><a href="chp9.html#stage-least-squares"><i class="fa fa-check"></i><b>11.1</b> 2 Stage Least Squares</a></li>
<li class="chapter" data-level="11.2" data-path="chp9.html"><a href="chp9.html#explanatory-power-of-the-instruments"><i class="fa fa-check"></i><b>11.2</b> Explanatory power of the instruments</a></li>
<li class="chapter" data-level="11.3" data-path="chp9.html"><a href="chp9.html#estimating-simultaneous-equation-model"><i class="fa fa-check"></i><b>11.3</b> Estimating Simultaneous Equation Model</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chp10.html"><a href="chp10.html"><i class="fa fa-check"></i><b>12</b> Experiments: Dealing with Real–World Challenges</a><ul>
<li class="chapter" data-level="12.1" data-path="chp10.html"><a href="chp10.html#assess-balance"><i class="fa fa-check"></i><b>12.1</b> Assess Balance</a></li>
<li class="chapter" data-level="12.2" data-path="chp10.html"><a href="chp10.html#estimate-itt-model"><i class="fa fa-check"></i><b>12.2</b> Estimate ITT Model</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chp11.html"><a href="chp11.html"><i class="fa fa-check"></i><b>13</b> Regression Discontinuity: Looking for Jumps in Data</a><ul>
<li class="chapter" data-level="13.1" data-path="chp11.html"><a href="chp11.html#same-slope"><i class="fa fa-check"></i><b>13.1</b> Same slope</a></li>
<li class="chapter" data-level="13.2" data-path="chp11.html"><a href="chp11.html#varying-slopes"><i class="fa fa-check"></i><b>13.2</b> Varying Slopes</a></li>
<li class="chapter" data-level="13.3" data-path="chp11.html"><a href="chp11.html#plot-rd-model"><i class="fa fa-check"></i><b>13.3</b> Plot RD Model</a></li>
<li class="chapter" data-level="13.4" data-path="chp11.html"><a href="chp11.html#rddtools-package"><i class="fa fa-check"></i><b>13.4</b> <code>rddtools</code> package</a><ul>
<li class="chapter" data-level="13.4.1" data-path="chp11.html"><a href="chp11.html#same-slope-1"><i class="fa fa-check"></i><b>13.4.1</b> Same slope</a></li>
<li class="chapter" data-level="13.4.2" data-path="chp11.html"><a href="chp11.html#varying-slopes-1"><i class="fa fa-check"></i><b>13.4.2</b> Varying Slopes</a></li>
<li class="chapter" data-level="13.4.3" data-path="chp11.html"><a href="chp11.html#scatter-plot"><i class="fa fa-check"></i><b>13.4.3</b> Scatter Plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="chp12.html"><a href="chp12.html"><i class="fa fa-check"></i><b>14</b> Dummy Dependent Variables</a><ul>
<li class="chapter" data-level="14.1" data-path="chp12.html"><a href="chp12.html#probit-estimation"><i class="fa fa-check"></i><b>14.1</b> Probit Estimation</a><ul>
<li class="chapter" data-level="14.1.1" data-path="chp12.html"><a href="chp12.html#eda"><i class="fa fa-check"></i><b>14.1.1</b> EDA</a></li>
<li class="chapter" data-level="14.1.2" data-path="chp12.html"><a href="chp12.html#estimate-the-model"><i class="fa fa-check"></i><b>14.1.2</b> Estimate the model</a></li>
<li class="chapter" data-level="14.1.3" data-path="chp12.html"><a href="chp12.html#estimated-effects"><i class="fa fa-check"></i><b>14.1.3</b> Estimated Effects</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="chp12.html"><a href="chp12.html#logit-estimation"><i class="fa fa-check"></i><b>14.2</b> Logit Estimation</a><ul>
<li class="chapter" data-level="14.2.1" data-path="chp12.html"><a href="chp12.html#discrete-differences"><i class="fa fa-check"></i><b>14.2.1</b> Discrete Differences</a></li>
<li class="chapter" data-level="14.2.2" data-path="chp12.html"><a href="chp12.html#marginal-effects-1"><i class="fa fa-check"></i><b>14.2.2</b> Marginal Effects</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="chp12.html"><a href="chp12.html#testing-hypotheses"><i class="fa fa-check"></i><b>14.3</b> Testing Hypotheses</a></li>
<li class="chapter" data-level="14.4" data-path="chp12.html"><a href="chp12.html#graphing-probit-and-logit-models"><i class="fa fa-check"></i><b>14.4</b> Graphing Probit and Logit Models</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="chp13.html"><a href="chp13.html"><i class="fa fa-check"></i><b>15</b> Time Series: Dealing with Stickiness over Time</a><ul>
<li class="chapter" data-level="15.1" data-path="chp13.html"><a href="chp13.html#time-series-objects-in-r"><i class="fa fa-check"></i><b>15.1</b> Time Series Objects in R</a></li>
<li class="chapter" data-level="15.2" data-path="chp13.html"><a href="chp13.html#detecting-autocorrelation"><i class="fa fa-check"></i><b>15.2</b> Detecting Autocorrelation</a></li>
<li class="chapter" data-level="15.3" data-path="chp13.html"><a href="chp13.html#correcting-autocorrelation"><i class="fa fa-check"></i><b>15.3</b> Correcting Autocorrelation</a><ul>
<li class="chapter" data-level="15.3.1" data-path="chp13.html"><a href="chp13.html#newey-west"><i class="fa fa-check"></i><b>15.3.1</b> Newey-West</a></li>
<li class="chapter" data-level="15.3.2" data-path="chp13.html"><a href="chp13.html#cochrane-orcutt"><i class="fa fa-check"></i><b>15.3.2</b> Cochrane-Orcutt</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="chp13.html"><a href="chp13.html#dynamic-models"><i class="fa fa-check"></i><b>15.4</b> Dynamic Models</a></li>
<li class="chapter" data-level="15.5" data-path="chp13.html"><a href="chp13.html#dickey-fuller-test"><i class="fa fa-check"></i><b>15.5</b> Dickey-Fuller Test</a></li>
<li class="chapter" data-level="15.6" data-path="chp13.html"><a href="chp13.html#first-differencing"><i class="fa fa-check"></i><b>15.6</b> First Differencing</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="chp14.html"><a href="chp14.html"><i class="fa fa-check"></i><b>16</b> Advanced OLS</a><ul>
<li class="chapter" data-level="16.1" data-path="chp14.html"><a href="chp14.html#derive-ols-estimator-matrix-form"><i class="fa fa-check"></i><b>16.1</b> Derive OLS estimator (Matrix Form)</a><ul>
<li class="chapter" data-level="16.1.1" data-path="chp14.html"><a href="chp14.html#example"><i class="fa fa-check"></i><b>16.1.1</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="chp14.html"><a href="chp14.html#gaussmarkov-theorem"><i class="fa fa-check"></i><b>16.2</b> Gauss–Markov Theorem</a><ul>
<li class="chapter" data-level="16.2.1" data-path="chp14.html"><a href="chp14.html#ols-estimator-is-linear"><i class="fa fa-check"></i><b>16.2.1</b> OLS estimator is linear</a></li>
<li class="chapter" data-level="16.2.2" data-path="chp14.html"><a href="chp14.html#ols-estimator-is-unbiased"><i class="fa fa-check"></i><b>16.2.2</b> OLS estimator is unbiased</a></li>
<li class="chapter" data-level="16.2.3" data-path="chp14.html"><a href="chp14.html#variance-covariance-is-a-minimum"><i class="fa fa-check"></i><b>16.2.3</b> Variance-Covariance is a minimum</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="chp4.html"><a href="chp4.html#probability-distributions-in-r"><i class="fa fa-check"></i><b>16.3</b> Probability Distributions in R</a><ul>
<li class="chapter" data-level="16.3.1" data-path="chp14.html"><a href="chp14.html#obtaining-critical-statistics"><i class="fa fa-check"></i><b>16.3.1</b> Obtaining Critical Statistics</a></li>
<li class="chapter" data-level="16.3.2" data-path="cph3.html"><a href="cph3.html#generating-random-numbers"><i class="fa fa-check"></i><b>16.3.2</b> Generating Random Numbers</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="chp15.html"><a href="chp15.html"><i class="fa fa-check"></i><b>17</b> Advanced Panel Data</a><ul>
<li class="chapter" data-level="17.1" data-path="chp15.html"><a href="chp15.html#the-data"><i class="fa fa-check"></i><b>17.1</b> The Data</a></li>
<li class="chapter" data-level="17.2" data-path="chp15.html"><a href="chp15.html#variation-within-units"><i class="fa fa-check"></i><b>17.2</b> Variation within Units</a></li>
<li class="chapter" data-level="17.3" data-path="chp15.html"><a href="chp15.html#two-way-fixed-effects-model"><i class="fa fa-check"></i><b>17.3</b> Two-Way Fixed Effects Model</a></li>
<li class="chapter" data-level="17.4" data-path="chp15.html"><a href="chp15.html#testing-for-autocorrelation"><i class="fa fa-check"></i><b>17.4</b> Testing for autocorrelation</a></li>
<li class="chapter" data-level="17.5" data-path="chp15.html"><a href="chp15.html#estimating-hatrho"><i class="fa fa-check"></i><b>17.5</b> Estimating <span class="math inline">\(\hat\rho\)</span></a></li>
<li class="chapter" data-level="17.6" data-path="chp15.html"><a href="chp15.html#estimate-a-rho-transformed-model"><i class="fa fa-check"></i><b>17.6</b> Estimate a <span class="math inline">\(\rho\)</span>-Transformed Model</a></li>
<li class="chapter" data-level="17.7" data-path="chp15.html"><a href="chp15.html#lagged-dependent-variable-panel-data-model"><i class="fa fa-check"></i><b>17.7</b> Lagged Dependent Variable Panel Data Model</a></li>
<li class="chapter" data-level="17.8" data-path="chp15.html"><a href="chp15.html#random-effects-model"><i class="fa fa-check"></i><b>17.8</b> Random Effects Model</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Companion to <em>Real Econometrics</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chp5" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Multivariate OLS: Where the Action Is</h1>
<div id="computing-corner" class="section level2">
<h2><span class="header-section-number">7.1</span> Computing Corner</h2>
<p>Packages needed for this chapter.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="chp5.html#cb1-1"></a><span class="kw">library</span>(car)</span>
<span id="cb1-2"><a href="chp5.html#cb1-2"></a><span class="kw">library</span>(broom)</span>
<span id="cb1-3"><a href="chp5.html#cb1-3"></a><span class="kw">library</span>(estimatr)</span>
<span id="cb1-4"><a href="chp5.html#cb1-4"></a><span class="kw">library</span>(lm.beta)</span>
<span id="cb1-5"><a href="chp5.html#cb1-5"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<p>In this chapter you will learn the basics of estimating multivariate OLS models.</p>
<div id="multiple-regression" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Multiple Regression</h3>
<p>To estimate a multiple regression (a regression with more than one independent variable) use the same function <code>lm</code> but change the formula argument to include the additional variables. In a simple regression, the formula argument was of the form <em>y ~ x</em>. In a multiple regression, the formula argument takes the form <em>y ~ x1 + x2</em>. To include additional variables, extend the argument in a similar manner <em>y ~ x1 + x2 + x3 + …</em>. The remaining arguments are the same as in the simple regression. You can assign the results to an object just as with a simple regression. The object returned will be the list of 12 elements, but the objects in the list will change to reflect the additional variable(s).</p>
<p>We can use <code>summary</code>, <code>broom::tidy</code>, etc. to view the output.</p>
<p>To make use of the results, you can use any of the functions described in Chapter 3 of this manual. You can also make use of any of the subsetting commands as well.</p>
<p>Estimate a regression with robust standard errors with <code>estimatr::lm_robust</code> with the modified function argument. Alternatively we can add the argument <em>robust = TRUE</em> to <code>jtools::summ</code>.</p>
</div>
<div id="multicollinearity" class="section level3">
<h3><span class="header-section-number">7.1.2</span> Multicollinearity</h3>
<p>You can directly estimate the VIF’s with the <code>vif()</code> function from the car package. To estimate the VIF’s call <code>ols %&gt;% vif()</code> where ols is the object you created with the <code>lm</code> call.</p>
</div>
<div id="standardized-coefficients" class="section level3">
<h3><span class="header-section-number">7.1.3</span> Standardized Coefficients</h3>
<p>Estimate standardized regression coefficients with <code>lm.beta::lm.beta()</code>. <code>ols %&gt;% lm.beta()</code>. Alternatively we can add the argument <em>scale = TRUE</em> to <code>jtools::summ</code></p>
</div>
<div id="f-tests" class="section level3">
<h3><span class="header-section-number">7.1.4</span> <em>F</em> tests</h3>
<p><em>F</em> tests in econometrics are generally about the joint significance of multiple variables. Suppose, we estimate the regression on <span class="math inline">\(i=1,2,\ldots n\)</span> observations. <span class="math display">\[y_i=\beta_0+\beta_1x_{1,i}+\beta_2x_{2,i}+\cdots+\beta_mx_{i,m}+\beta_{m+1}x_{m+1,i}+\cdots+\beta_kx_{i,k} + \epsilon_i\]</span></p>
<p>To test the joint significance of the <span class="math inline">\(\beta_1,\ldots,\beta_m\)</span> in the model we would use an <em>F</em> test to perform the following hypothesis test: <span class="math display">\[H_0: \beta_1=\beta_2=\cdots=\beta_m=0\]</span> <span class="math display">\[H_1:\text{@ least one }\beta_j\ne0\]</span></p>
<p>An <em>F</em> test compares the difference in the residual sum of squares under the null and alternative hypotheses. If this difference in large enough relative to the unrestricted standard error, we have evidence to reject the null hypothesis in favor of the alternative hypothesis. The mechanics of the test are as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Estimate the model that does not hold under the null hypothesis, that is, the model above and call it the unrestricted model and retrieve the residual sum of squares. Retrieve the residual sum of squares, <span class="math inline">\(rss_u\)</span>. The residuals from unrestricted model will have <span class="math inline">\(n-k-1\)</span> degrees of freedom. The unrestricted model, U, is: <span class="math display">\[\text{U: }y_i=\beta_0+\beta_1x_{1,i}+\beta_2x_{2,i}+\cdots+\beta_mx_{i,m}+\beta_{m+1}x_{m+1,i}+\cdots+\beta_kx_{i,k} + \epsilon_i\]</span></p></li>
<li><p>Estimate the model that holds under the null hypothesis Restrict the model so that the null hypothesis holds. That restricted model, R, is <span class="math display">\[\text{R: }y_i=\beta_0+\beta_{m+1}x_{m+1,i}+\beta_{m+2}x_{m+2,i}+\cdots+\beta_kx_{k,i} + \eta_i\]</span>. Retrieve the residual sum of squares <span class="math inline">\(rss_r\)</span> The residual from restricted model will have <span class="math inline">\(n-m-1\)</span> degrees of freedom.</p></li>
<li><p>Calculate the difference in the residual sum of squares <span class="math inline">\(rss_r - rss_u\)</span> and divide by its degrees of of freedom <span class="math inline">\(q = (n-m-1)-(n-k-1) = k-m\)</span>. q is the number of restrictions placed on the model. A simple way to calculate the number of restrictions is to count the number of equal signs (<span class="math inline">\(=\)</span>) in the null hypothesis.</p></li>
<li><p>Calculate <span class="math inline">\(rss_u/(n-k-1)\)</span></p></li>
<li><p>Divide the result from 3 by the result from 4. This will give you an <em>F</em> statistic with <span class="math inline">\(k-m\)</span> and <span class="math inline">\(n-k-1\)</span> degrees of freedom.</p></li>
</ol>
<p><span class="math display">\[F_c=\frac{\frac{rss_r-rss_u}{q}}{\frac{rss_u}{n-k-1}}\]</span></p>
<p>The <em>F</em>-test (Wald test) can be used for any number of restrictions on the unrestricted model. For example, suppose we would like to know if a production function with a Cobb-Douglas form has constant returns to scale. The Cobb-Douglas function for output as a function of labor and capital takes the form <span class="math display">\[q=al^\alpha k^\beta\epsilon\]</span>. If constant returns to scale hold, <span class="math inline">\(\alpha+\beta=1\)</span>. So we test the following hypothesis: <span class="math display">\[H_0:\alpha+\beta=1\]</span> <span class="math display">\[H_1:\alpha+\beta\ne1\]</span></p>
<p>To test this hypothesis form the unrestricted and restricted forms of the model, estimate the models, retrieve the sum of squared residuals, and calculate the <em>F</em> statistic. In the form presented above, the Cobb-Douglas model is not linear in the parameters so it can’t be estimated with OLS. We can make it linear in the parameters by taking the logarithm of both sides. <span class="math display">\[\ln(q)=\ln(al^\alpha k^\beta\epsilon)\]</span> <span class="math display">\[\text{U: }\ln(q)=\gamma+\alpha \ln(l)+\beta\ln(k)+\epsilon\]</span>.</p>
<p>Form the restricted model by imposing the null hypothesis on the parameters. From the null hypothesis, <span class="math inline">\(\beta=1-\alpha\)</span>. Substituting for <span class="math inline">\(\beta\)</span> in the restricted model yields the restricted model. <span class="math display">\[\text{R: }\ln(q)-\ln(k)=\gamma+\alpha[\ln(l)-\ln(k)]+\eta\]</span></p>
<p>The <em>F</em>-stat is: <span class="math display">\[F_c=\frac{rss_r-rss_u}{\frac{rss_u}{n-k-1}}\]</span></p>
<p>The degrees of freedom are <span class="math inline">\(q=1\)</span> (the number of equal signs in the null hypothesis) and <span class="math inline">\(n-k-1\)</span>.</p>
<div id="f-test-for-overall-significance." class="section level4">
<h4><span class="header-section-number">7.1.4.1</span> <em>F</em>-test for overall significance.</h4>
<p>Estimate the model <span class="math inline">\(y_i=\beta_0+\beta_1x_{1,i}+\beta_2x_{2,i}+\cdots+\beta_kx_{k,i}+\epsilon_i\)</span>. Test the hypothesis <span class="math display">\[H_0: \beta_1=\beta_2=\cdots=\beta_k=0\]</span> <span class="math display">\[H_1:\text{@ least one }\beta_j\ne0\]</span></p>
<p>If we reject the null hypothesis, we can say that we have explained some variation in <span class="math inline">\(y\)</span> with variation in at least one of the <span class="math inline">\(x&#39;s\)</span>. In other words, we have a model that is significant. If we fail to reject the null hypothesis, our model has no explanatory power. There is no need to calculate the <em>F</em>-statistic to perform this test because it is reported as a matter of course in the base R call <code>summary</code> or in <code>glance</code> from the broom package. The degrees of freedom are <span class="math inline">\(q=k\)</span> (the number of coefficients estimated - 1) and <span class="math inline">\(n-k-1\)</span>.</p>
<p><code>summary</code> will report the F-statistic, its degrees of freedom (numerator and denominator), and the p-value. <code>glance</code> reports the <em>F</em> as “statistic”, the p-value as “p.value”, <span class="math inline">\(k\)</span> as “df”, and <span class="math inline">\(n-k-1\)</span> as “df.residual”. Note that this test is also a test for the significance of <span class="math inline">\(R^2\)</span>.</p>
</div>
<div id="f-test-of-linear-restrictions" class="section level4">
<h4><span class="header-section-number">7.1.4.2</span> <em>F</em>-test of linear restrictions</h4>
<p>The test we performed above are tests of linear restrictions of the parameters. These hypotheses can be tested directly using <code>car::linearHypothesis</code> from the car package. Performing a test of linear restrictions using <code>car::linearHypothesis</code> requires two arguments: model and hypothesis.matrix.</p>
<p>Let the unrestricted model be <span class="math display">\[y=\beta_0+\beta_1x_1+\beta_2x_2+\beta_3x_3+\epsilon\]</span> Estimate the model as <code>df %&gt;% lm(y ~ x1 + x2 + x3, .)</code>, where <em>df</em> is the data frame containing the data.</p>
<p>Let’s test the hypothesis <span class="math inline">\(\beta_2=\beta_3=0\)</span> versus at that one of the <span class="math inline">\(\beta\text{&#39;s}\ne0\)</span> by including an argument for the null hypothesis as:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="chp5.html#cb2-1"></a>df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-2"><a href="chp5.html#cb2-2"></a><span class="st">  </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>x3, .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb2-3"><a href="chp5.html#cb2-3"></a><span class="st">  </span>car<span class="op">::</span><span class="kw">linearHypothesis</span>(<span class="dt">hypothesis.matrix =</span> <span class="kw">c</span>(<span class="st">&quot;x2 = 0&quot;</span>, <span class="st">&quot;x3 = 0&quot;</span>))</span></code></pre></div>
<p>The result will be an <em>F</em>-test on the restrictions. The <em>F</em>-statistic, its degrees of freedom, and <em>p-value</em> will be returned.</p>
<p>Let’s test the linear restriction for the Cobb-Douglas model above.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="chp5.html#cb3-1"></a>df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-2"><a href="chp5.html#cb3-2"></a><span class="st">  </span><span class="kw">lm</span>(<span class="kw">log</span>(q) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(l) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(k), .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb3-3"><a href="chp5.html#cb3-3"></a><span class="st">  </span>car<span class="op">::</span><span class="kw">linearHypothesis</span>(<span class="kw">c</span>(<span class="st">&quot;log(l) = log(k)&quot;</span>))</span></code></pre></div>
<p>Again, the <em>F</em>-statistic, its degrees of freedom, and <em>p-value</em> will be returned.</p>
</div>
<div id="examples" class="section level4">
<h4><span class="header-section-number">7.1.4.3</span> Examples</h4>
<p>The Motor Trend Car Road Test (<em>mtcars</em>) data set is part of the datasets in base R. The data were extracted from the 1974 Motor Trend US magazine, and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973-74 models). See <code>?mtcars</code> for more information on the data. <code>data(mtcars)</code> will load the data into your global environment as mtcars.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> We will perform each of the <em>F</em>-tests described above: overall significance, joint significance of a subset of variables, and equality of two coefficients.</p>
<div id="multiple-regression-1" class="section level5">
<h5><span class="header-section-number">7.1.4.3.1</span> Multiple Regression</h5>
<p>Suppose we want to estimate the mpg as a function of the number of cylinders, the displacement, and the gross horsepower, our (unrestricted) model is <span class="math display">\[mpg=\beta_0+\beta_1cyl+\beta_2disp+\beta_3hp+\epsilon\]</span>.</p>
<p>Let’s estimate the unrestricted model both with and without robust errors.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="chp5.html#cb4-1"></a><span class="co"># estimate model without robust standard errors</span></span>
<span id="cb4-2"><a href="chp5.html#cb4-2"></a>ols &lt;-<span class="st"> </span></span>
<span id="cb4-3"><a href="chp5.html#cb4-3"></a><span class="st">  </span>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-4"><a href="chp5.html#cb4-4"></a><span class="st">  </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>hp, .)</span>
<span id="cb4-5"><a href="chp5.html#cb4-5"></a></span>
<span id="cb4-6"><a href="chp5.html#cb4-6"></a>ols <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-7"><a href="chp5.html#cb4-7"></a><span class="st">  </span><span class="kw">tidy</span>()</span></code></pre></div>
<pre><code># A tibble: 4 x 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)  34.2       2.59       13.2  1.54e-13
2 cyl          -1.23      0.797      -1.54 1.35e- 1
3 disp         -0.0188    0.0104     -1.81 8.09e- 2
4 hp           -0.0147    0.0147     -1.00 3.25e- 1</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="chp5.html#cb6-1"></a><span class="co"># estimate model with robust standard errors</span></span>
<span id="cb6-2"><a href="chp5.html#cb6-2"></a>ols_robust &lt;-<span class="st"> </span></span>
<span id="cb6-3"><a href="chp5.html#cb6-3"></a><span class="st">  </span>mtcars <span class="op">%&gt;%</span></span>
<span id="cb6-4"><a href="chp5.html#cb6-4"></a><span class="st">  </span><span class="kw">lm_robust</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>hp, .)</span>
<span id="cb6-5"><a href="chp5.html#cb6-5"></a></span>
<span id="cb6-6"><a href="chp5.html#cb6-6"></a>ols_robust <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb6-7"><a href="chp5.html#cb6-7"></a><span class="st">  </span><span class="kw">tidy</span>()</span></code></pre></div>
<pre><code>         term estimate std.error statistic           p.value conf.low conf.high df outcome
1 (Intercept)  34.1849    2.4700     13.84 0.000000000000048  29.1253  39.24451 28     mpg
2         cyl  -1.2274    0.5967     -2.06 0.049121075438813  -2.4498  -0.00506 28     mpg
3        disp  -0.0188    0.0083     -2.27 0.031138440490781  -0.0358  -0.00183 28     mpg
4          hp  -0.0147    0.0109     -1.34 0.190818678697032  -0.0371   0.00775 28     mpg</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="chp5.html#cb8-1"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-2"><a href="chp5.html#cb8-2"></a><span class="st">  </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>hp, .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb8-3"><a href="chp5.html#cb8-3"></a><span class="st">  </span>jtools<span class="op">::</span><span class="kw">summ</span>(<span class="dt">robust =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
Observations
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Dependent variable
</td>
<td style="text-align:right;">
mpg
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Type
</td>
<td style="text-align:right;">
OLS linear regression
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
F(3,28)
</td>
<td style="text-align:right;">
30.88
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
R²
</td>
<td style="text-align:right;">
0.77
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Adj. R²
</td>
<td style="text-align:right;">
0.74
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Est.
</th>
<th style="text-align:right;">
S.E.
</th>
<th style="text-align:right;">
t val.
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
34.18
</td>
<td style="text-align:right;">
2.61
</td>
<td style="text-align:right;">
13.09
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
cyl
</td>
<td style="text-align:right;">
-1.23
</td>
<td style="text-align:right;">
0.64
</td>
<td style="text-align:right;">
-1.92
</td>
<td style="text-align:right;">
0.06
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
disp
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-2.05
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
hp
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-1.15
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup></sup> Standard errors: Robust, type = HC3
</td>
</tr>
</tfoot>
</table>
</div>
</div>
<div id="multicollinearity-1" class="section level4">
<h4><span class="header-section-number">7.1.4.4</span> Multicollinearity</h4>
<p>Using the model above <span class="math display">\[mpg=\beta_0+\beta_1cyl+\beta_2disp+\beta_3hp+\epsilon\]</span>.</p>
<p>We can calculate the VIF’s as follows:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="chp5.html#cb9-1"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-2"><a href="chp5.html#cb9-2"></a><span class="st">  </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>hp, .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-3"><a href="chp5.html#cb9-3"></a><span class="st">  </span><span class="kw">vif</span>()</span></code></pre></div>
<pre><code> cyl disp   hp 
6.73 5.52 3.35 </code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="chp5.html#cb11-1"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-2"><a href="chp5.html#cb11-2"></a><span class="st">  </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>hp, .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-3"><a href="chp5.html#cb11-3"></a><span class="st">  </span>jtools<span class="op">::</span><span class="kw">summ</span>(<span class="dt">vifs =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
Observations
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Dependent variable
</td>
<td style="text-align:right;">
mpg
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Type
</td>
<td style="text-align:right;">
OLS linear regression
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
F(3,28)
</td>
<td style="text-align:right;">
30.88
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
R²
</td>
<td style="text-align:right;">
0.77
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Adj. R²
</td>
<td style="text-align:right;">
0.74
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Est.
</th>
<th style="text-align:right;">
S.E.
</th>
<th style="text-align:right;">
t val.
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:right;">
VIF
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
34.18
</td>
<td style="text-align:right;">
2.59
</td>
<td style="text-align:right;">
13.19
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
cyl
</td>
<td style="text-align:right;">
-1.23
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
-1.54
</td>
<td style="text-align:right;">
0.13
</td>
<td style="text-align:right;">
6.73
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
disp
</td>
<td style="text-align:right;">
-0.02
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-1.81
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
5.52
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
hp
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
-1.00
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
3.35
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup></sup> Standard errors: OLS
</td>
</tr>
</tfoot>
</table>
</div>
<div id="standardize-regression-coefficients" class="section level4">
<h4><span class="header-section-number">7.1.4.5</span> Standardize Regression Coefficients</h4>
<p>Using the model <span class="math display">\[mpg=\beta_0+\beta_1cyl+\beta_2disp+\beta_3hp+\epsilon\]</span>, estimate standardized regression coefficients as follows:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="chp5.html#cb12-1"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-2"><a href="chp5.html#cb12-2"></a><span class="st">  </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>hp, .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-3"><a href="chp5.html#cb12-3"></a><span class="st">  </span>jtools<span class="op">::</span><span class="kw">summ</span>(<span class="dt">scale =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
Observations
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Dependent variable
</td>
<td style="text-align:right;">
mpg
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Type
</td>
<td style="text-align:right;">
OLS linear regression
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
F(3,28)
</td>
<td style="text-align:right;">
30.88
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
R²
</td>
<td style="text-align:right;">
0.77
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
Adj. R²
</td>
<td style="text-align:right;">
0.74
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Est.
</th>
<th style="text-align:right;">
S.E.
</th>
<th style="text-align:right;">
t val.
</th>
<th style="text-align:right;">
p
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-weight: bold;">
(Intercept)
</td>
<td style="text-align:right;">
20.09
</td>
<td style="text-align:right;">
0.54
</td>
<td style="text-align:right;">
37.20
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
cyl
</td>
<td style="text-align:right;">
-2.19
</td>
<td style="text-align:right;">
1.42
</td>
<td style="text-align:right;">
-1.54
</td>
<td style="text-align:right;">
0.13
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
disp
</td>
<td style="text-align:right;">
-2.33
</td>
<td style="text-align:right;">
1.29
</td>
<td style="text-align:right;">
-1.81
</td>
<td style="text-align:right;">
0.08
</td>
</tr>
<tr>
<td style="text-align:left;font-weight: bold;">
hp
</td>
<td style="text-align:right;">
-1.01
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
-1.00
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup></sup> Standard errors: OLS; Continuous predictors are mean-centered and scaled by 1 s.d.
</td>
</tr>
</tfoot>
</table>
</div>
<div id="f-test-for-overall-significance" class="section level4">
<h4><span class="header-section-number">7.1.4.6</span> <em>F</em>-test for Overall significance</h4>
<p>Suppose we want to estimate the mpg as a function of the number of cylinders, the displacement, and the gross horsepower, then our (unrestricted) model is <span class="math display">\[mpg=\beta_0+\beta_1cyl+\beta_2disp+\beta_3hp+\epsilon\]</span>.</p>
<p>Let’s estimate the unrestricted model</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chp5.html#cb13-1"></a>ols_u &lt;-<span class="st"> </span></span>
<span id="cb13-2"><a href="chp5.html#cb13-2"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-3"><a href="chp5.html#cb13-3"></a><span class="st">  </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>hp, .)</span></code></pre></div>
<p>The test for overall significance is:</p>
<p><span class="math display">\[\begin{align}H_0&amp;:\beta_1=\beta_2=\beta_3=0\\
H_1&amp;: \text{@ least one }\beta_j\ne0\end{align}\]</span></p>
<p>Recall that <em>the</em> <em>F</em>-test is reported as a matter of course in <code>summary</code> from base R and <code>glance</code> from the broom package.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="chp5.html#cb14-1"></a>ols_u <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-2"><a href="chp5.html#cb14-2"></a><span class="st">  </span><span class="kw">summary</span>()</span></code></pre></div>
<pre><code>
Call:
lm(formula = mpg ~ cyl + disp + hp, data = .)

Residuals:
   Min     1Q Median     3Q    Max 
-4.089 -2.085 -0.774  1.397  6.918 

Coefficients:
            Estimate Std. Error t value         Pr(&gt;|t|)    
(Intercept)  34.1849     2.5908   13.19 0.00000000000015 ***
cyl          -1.2274     0.7973   -1.54            0.135    
disp         -0.0188     0.0104   -1.81            0.081 .  
hp           -0.0147     0.0147   -1.00            0.325    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 3.06 on 28 degrees of freedom
Multiple R-squared:  0.768,	Adjusted R-squared:  0.743 
F-statistic: 30.9 on 3 and 28 DF,  p-value: 0.00000000505</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="chp5.html#cb16-1"></a>ols_u <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-2"><a href="chp5.html#cb16-2"></a><span class="st">  </span><span class="kw">glance</span>()</span></code></pre></div>
<pre><code># A tibble: 1 x 12
  r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC deviance df.residual
      &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt;
1     0.768         0.743  3.06      30.9 5.05e-9     3  -79.0  168.  175.     261.          28
# ... with 1 more variable: nobs &lt;int&gt;</code></pre>
<p>So we see that <span class="math inline">\(F=30.877\)</span>, <span class="math inline">\(q=3\)</span>, and <span class="math inline">\(df2=28\)</span>. The critical <em>F</em> with <span class="math inline">\(\alpha=.05\)</span> is <span class="math inline">\(2.947\)</span>. Since the calculated <em>F</em>-stat is greater than the critical <em>F</em>-stat, we reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span>. That is, the explanatory power of the model is statistical significant.</p>
<p>Here we estimated our model, assigned it to the object <em>ols_u</em>, and piped that object into the summary functions. We should note, that the pipe operator (<code>%&gt;%</code>) allows us to skip this assignment. Skipping this assignment can make our code clearer by making the object we are manipulating more clear than it’s name alone can make it. In the examples below, we will avoid assigning intermediate objects where we can.</p>
</div>
<div id="f-test-of-joint-significance" class="section level4">
<h4><span class="header-section-number">7.1.4.7</span> <em>F</em>-test of Joint Significance</h4>
<p>Suppose we’d like to add the weight <span class="math inline">\(wt\)</span>, number of gears <span class="math inline">\(gear\)</span>, and number of carburetors <span class="math inline">\(carb\)</span> together increase the explanatory power of the model at the <span class="math inline">\(\alpha=.05\)</span>, level of significance. Our unrestricted model becomes: <span class="math display">\[mpg=\beta_0+\beta_1cyl+\beta_2disp+\beta_3hp+\beta_4wt+\beta_5gear+\beta_6carb+\eta\]</span>.</p>
<p>The null and alternative hypotheses are:</p>
<p><span class="math display">\[\begin{align} H_0&amp;:\beta_4=\beta_5=\beta_6=0 \\
H_1&amp;:\text{@ least one }\beta_j\ne0
\end{align}\]</span></p>
</div>
<div id="perform-the-test-manually" class="section level4">
<h4><span class="header-section-number">7.1.4.8</span> Perform the test “manually”</h4>
<p>We can retrieve <span class="math inline">\(ssr\)</span> and a degrees of freedom with <code>broom::glance</code>. <code>broom::glance</code> reports information about the entire model including sum of squared residuals and degrees of freedom, <em>etc.</em>, and returns a tibble. We can use <code>dplyr::select</code> to get the values we want in a tibble. The sum of squared residuals, <span class="math inline">\(\sum\hat{e}^{2}_{i}\)</span>, is named <em>deviance</em> while the degrees of freedom we want is named <em>df.residual</em>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chp5.html#cb18-1"></a><span class="co"># estimate the unrestricted model and retrieve ssr and df</span></span>
<span id="cb18-2"><a href="chp5.html#cb18-2"></a>unrestricted &lt;-<span class="st"> </span></span>
<span id="cb18-3"><a href="chp5.html#cb18-3"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-4"><a href="chp5.html#cb18-4"></a><span class="st">  </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>hp <span class="op">+</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>gear <span class="op">+</span><span class="st"> </span>carb, .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-5"><a href="chp5.html#cb18-5"></a><span class="st">  </span>broom<span class="op">::</span><span class="kw">glance</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-6"><a href="chp5.html#cb18-6"></a><span class="st">  </span><span class="kw">select</span>(<span class="dt">ssr_u =</span> deviance, <span class="dt">df_u =</span> df.residual) </span>
<span id="cb18-7"><a href="chp5.html#cb18-7"></a></span>
<span id="cb18-8"><a href="chp5.html#cb18-8"></a><span class="co"># estimate the restricted model and retrieve ssr and df</span></span>
<span id="cb18-9"><a href="chp5.html#cb18-9"></a>restricted &lt;-<span class="st"> </span></span>
<span id="cb18-10"><a href="chp5.html#cb18-10"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-11"><a href="chp5.html#cb18-11"></a><span class="st">  </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>hp, .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-12"><a href="chp5.html#cb18-12"></a><span class="st">  </span>broom<span class="op">::</span><span class="kw">glance</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-13"><a href="chp5.html#cb18-13"></a><span class="st">  </span><span class="kw">select</span>(<span class="dt">ssr_r =</span> deviance, <span class="dt">df_r =</span> df.residual)</span>
<span id="cb18-14"><a href="chp5.html#cb18-14"></a></span>
<span id="cb18-15"><a href="chp5.html#cb18-15"></a><span class="co"># combine the tibbles and calculate F and F_crit.</span></span>
<span id="cb18-16"><a href="chp5.html#cb18-16"></a><span class="co"># bind_cols &quot;stacks&quot; the tibbles on top of each other</span></span>
<span id="cb18-17"><a href="chp5.html#cb18-17"></a></span>
<span id="cb18-18"><a href="chp5.html#cb18-18"></a><span class="kw">bind_cols</span>(unrestricted, restricted) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-19"><a href="chp5.html#cb18-19"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">q =</span> df_r <span class="op">-</span><span class="st"> </span>df_u,</span>
<span id="cb18-20"><a href="chp5.html#cb18-20"></a>         <span class="dt">numerator =</span> (ssr_r <span class="op">-</span><span class="st"> </span>ssr_u) <span class="op">/</span><span class="st"> </span>q,</span>
<span id="cb18-21"><a href="chp5.html#cb18-21"></a>         <span class="dt">denominator =</span> ssr_u <span class="op">/</span><span class="st"> </span>df_u,</span>
<span id="cb18-22"><a href="chp5.html#cb18-22"></a>         <span class="dt">F_calc =</span> numerator <span class="op">/</span><span class="st"> </span>denominator,</span>
<span id="cb18-23"><a href="chp5.html#cb18-23"></a>         <span class="dt">F_crit =</span> <span class="kw">qf</span>(.<span class="dv">95</span>, df_r <span class="op">-</span><span class="st"> </span>df_u, df_u),</span>
<span id="cb18-24"><a href="chp5.html#cb18-24"></a>         <span class="dt">p_value =</span> <span class="kw">pf</span>(F_calc, q, df_u, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-25"><a href="chp5.html#cb18-25"></a><span class="st">  </span><span class="kw">select</span>(F_calc, F_crit, p_value, df_u, df_r, q) -&gt;</span>
<span id="cb18-26"><a href="chp5.html#cb18-26"></a><span class="st">  </span>wald</span>
<span id="cb18-27"><a href="chp5.html#cb18-27"></a></span>
<span id="cb18-28"><a href="chp5.html#cb18-28"></a>wald</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  F_calc F_crit p_value  df_u  df_r     q
   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1   4.80   2.99 0.00897    25    28     3</code></pre>
<p>Since 4.796 is greater than 2.991 we can reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_1\)</span> and conclude that <em>wt</em>, <em>am</em>, and <em>carb</em> add significant explanatory power to the model. We can also see that the p-value for our calculated <em>F</em>-statistic is 0.009. Since this is less than <span class="math inline">\(\alpha=.05\)</span> we reject <span class="math inline">\(H_0\)</span>.</p>
</div>
<div id="perform-the-test-with-linearhypothesis" class="section level4">
<h4><span class="header-section-number">7.1.4.9</span> Perform the test with <code>linearHypothesis</code></h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="chp5.html#cb20-1"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-2"><a href="chp5.html#cb20-2"></a><span class="st">  </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>cyl <span class="op">+</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>hp <span class="op">+</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>gear <span class="op">+</span><span class="st"> </span>carb, .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-3"><a href="chp5.html#cb20-3"></a><span class="st">  </span><span class="kw">linearHypothesis</span>(<span class="kw">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;gear&quot;</span>, <span class="st">&quot;carb&quot;</span>))</span></code></pre></div>
<pre><code>Linear hypothesis test

Hypothesis:
wt = 0
gear = 0
carb = 0

Model 1: restricted model
Model 2: mpg ~ cyl + disp + hp + wt + gear + carb

  Res.Df RSS Df Sum of Sq   F Pr(&gt;F)   
1     28 261                           
2     25 166  3      95.5 4.8  0.009 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Of course, we have the same result.</p>
</div>
<div id="test-of-linear-restrictions" class="section level4">
<h4><span class="header-section-number">7.1.4.10</span> Test of Linear Restrictions</h4>
<p>Let the model be <span class="math display">\[\ln(mpg)=\beta_0+\beta_1\ln(cyl)+\beta_2\ln(wt)+\epsilon\]</span>. Suppose we’d like to test <span class="math display">\[H_0:\beta_1+\beta_2=-1\]</span> against <span class="math display">\[H_0:\beta_1+\beta_2\ne-1\]</span></p>
<div id="perform-the-test-manually-1" class="section level5">
<h5><span class="header-section-number">7.1.4.10.1</span> Perform the Test “Manually”</h5>
<p>Form the restricted model under <span class="math inline">\(H_0\)</span>. If <span class="math inline">\(H_0\)</span> holds, <span class="math inline">\(\beta_2=-1-\beta_1\)</span>. Substituting into the unrestricted model yields the restricted model: <span class="math display">\[\text{R: }\ln(mpg)+\ln(wt)=\beta_0+\beta_1(\ln(cyl)-\ln(wt))+\eta\]</span></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="chp5.html#cb22-1"></a>unrestricted &lt;-<span class="st"> </span></span>
<span id="cb22-2"><a href="chp5.html#cb22-2"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-3"><a href="chp5.html#cb22-3"></a><span class="st">  </span><span class="kw">lm</span>(<span class="kw">log</span>(mpg) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(cyl) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(wt), .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-4"><a href="chp5.html#cb22-4"></a><span class="st">  </span>broom<span class="op">::</span><span class="kw">glance</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-5"><a href="chp5.html#cb22-5"></a><span class="st">  </span><span class="kw">select</span>(<span class="dt">ssr_u =</span> deviance, <span class="dt">df_u =</span> df.residual) </span>
<span id="cb22-6"><a href="chp5.html#cb22-6"></a></span>
<span id="cb22-7"><a href="chp5.html#cb22-7"></a><span class="co"># estimate the restricted model and retrieve ssr and df</span></span>
<span id="cb22-8"><a href="chp5.html#cb22-8"></a>restricted &lt;-<span class="st"> </span></span>
<span id="cb22-9"><a href="chp5.html#cb22-9"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-10"><a href="chp5.html#cb22-10"></a><span class="st">  </span><span class="kw">lm</span>(<span class="kw">I</span>(<span class="kw">log</span>(mpg)<span class="op">+</span><span class="kw">log</span>(wt)) <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="kw">log</span>(cyl) <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(wt)), .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-11"><a href="chp5.html#cb22-11"></a><span class="st">  </span>broom<span class="op">::</span><span class="kw">glance</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-12"><a href="chp5.html#cb22-12"></a><span class="st">  </span><span class="kw">select</span>(<span class="dt">ssr_r =</span> deviance, <span class="dt">df_r =</span> df.residual)</span>
<span id="cb22-13"><a href="chp5.html#cb22-13"></a></span>
<span id="cb22-14"><a href="chp5.html#cb22-14"></a><span class="co"># combine the tibbles and calculate F and F_crit.</span></span>
<span id="cb22-15"><a href="chp5.html#cb22-15"></a><span class="co"># bind_cols &quot;stacks&quot; the tibbles on top of each other</span></span>
<span id="cb22-16"><a href="chp5.html#cb22-16"></a></span>
<span id="cb22-17"><a href="chp5.html#cb22-17"></a><span class="kw">bind_cols</span>(unrestricted, restricted) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-18"><a href="chp5.html#cb22-18"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">q =</span> df_r <span class="op">-</span><span class="st"> </span>df_u,</span>
<span id="cb22-19"><a href="chp5.html#cb22-19"></a>         <span class="dt">numerator =</span> (ssr_r <span class="op">-</span><span class="st"> </span>ssr_u) <span class="op">/</span><span class="st"> </span>(q),</span>
<span id="cb22-20"><a href="chp5.html#cb22-20"></a>         <span class="dt">denominator =</span> ssr_u <span class="op">/</span><span class="st"> </span>df_u,</span>
<span id="cb22-21"><a href="chp5.html#cb22-21"></a>         <span class="dt">F_calc =</span> numerator <span class="op">/</span><span class="st"> </span>denominator,</span>
<span id="cb22-22"><a href="chp5.html#cb22-22"></a>         <span class="dt">F_crit =</span> <span class="kw">qf</span>(.<span class="dv">95</span>, df_r <span class="op">-</span><span class="st"> </span>df_u, df_u),</span>
<span id="cb22-23"><a href="chp5.html#cb22-23"></a>         <span class="dt">p_value =</span> <span class="kw">pf</span>(F_calc, q, df_u, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb22-24"><a href="chp5.html#cb22-24"></a><span class="st">  </span><span class="kw">select</span>(F_calc, F_crit, p_value, df_u, df_r, q) -&gt;</span>
<span id="cb22-25"><a href="chp5.html#cb22-25"></a><span class="st">  </span>wald</span>
<span id="cb22-26"><a href="chp5.html#cb22-26"></a></span>
<span id="cb22-27"><a href="chp5.html#cb22-27"></a>wald</span></code></pre></div>
<pre><code># A tibble: 1 x 6
  F_calc F_crit p_value  df_u  df_r     q
   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
1   1.29   4.18   0.266    29    30     1</code></pre>
<p>Since 1.289 is less than 4.183 we can fail to reject <span class="math inline">\(H_0\)</span> and conclude that we have no evidence to suggest that <span class="math inline">\(\beta_1+\beta_2\ne1\)</span>. We can also see that the p-value for our calculated <em>F</em>-statistic is 0.266. Since this is greater than <span class="math inline">\(\alpha=.05\)</span> we fail to reject <span class="math inline">\(H_0\)</span>.</p>
</div>
</div>
<div id="perform-the-test-with-linearhypothesis-1" class="section level4">
<h4><span class="header-section-number">7.1.4.11</span> Perform the test with <code>linearHypothesis</code></h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="chp5.html#cb24-1"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-2"><a href="chp5.html#cb24-2"></a><span class="st">  </span><span class="kw">lm</span>(<span class="kw">log</span>(mpg) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(cyl) <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(wt), .) <span class="op">%&gt;%</span></span>
<span id="cb24-3"><a href="chp5.html#cb24-3"></a><span class="st">  </span><span class="kw">linearHypothesis</span>(<span class="kw">c</span>(<span class="st">&quot;log(cyl) + log(wt) = -1&quot;</span>))</span></code></pre></div>
<pre><code>Linear hypothesis test

Hypothesis:
log(cyl)  + log(wt) = - 1

Model 1: restricted model
Model 2: log(mpg) ~ log(cyl) + log(wt)

  Res.Df   RSS Df Sum of Sq    F Pr(&gt;F)
1     30 0.419                         
2     29 0.401  1    0.0178 1.29   0.27</code></pre>

</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>There can be no values <em>&lt;= 0</em>.<a href="chp5.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>This step is not necessary. You can use <em>mtcars</em> or any base R dataset without first loading into the global environment.<a href="chp5.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chp4.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chp6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bailey.pdf", "bailey.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
